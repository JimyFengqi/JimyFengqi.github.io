---
title: 391-å®Œç¾çŸ©å½¢(Perfect Rectangle)
categories:
  - å›°éš¾
tags:
  - æ•°ç»„
  - æ‰«æçº¿
abbrlink: 3945810560
date: 2021-12-03 22:48:43
---

> åŸæ–‡é“¾æ¥: https://leetcode-cn.com/problems/perfect-rectangle


## è‹±æ–‡åŸæ–‡
<div><p>Given an array <code>rectangles</code> where <code>rectangles[i] = [x<sub>i</sub>, y<sub>i</sub>, a<sub>i</sub>, b<sub>i</sub>]</code> represents an axis-aligned rectangle. The bottom-left point of the rectangle is <code>(x<sub>i</sub>, y<sub>i</sub>)</code> and the top-right point of it is <code>(a<sub>i</sub>, b<sub>i</sub>)</code>.</p>

<p>Return <code>true</code> <em>if all the rectangles together form an exact cover of a rectangular region</em>.</p>

<p>&nbsp;</p>
<p><strong>Example 1:</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perectrec1-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>Input:</strong> rectangles = [[1,1,3,3],[3,1,4,2],[3,2,4,4],[1,3,2,4],[2,3,3,4]]
<strong>Output:</strong> true
<strong>Explanation:</strong> All 5 rectangles together form an exact cover of a rectangular region.
</pre>

<p><strong>Example 2:</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perfectrec2-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>Input:</strong> rectangles = [[1,1,2,3],[1,3,2,4],[3,1,4,2],[3,2,4,4]]
<strong>Output:</strong> false
<strong>Explanation:</strong> Because there is a gap between the two rectangular regions.
</pre>

<p><strong>Example 3:</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perfectrec3-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>Input:</strong> rectangles = [[1,1,3,3],[3,1,4,2],[1,3,2,4],[3,2,4,4]]
<strong>Output:</strong> false
<strong>Explanation:</strong> Because there is a gap in the top center.
</pre>

<p><strong>Example 4:</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perfecrrec4-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>Input:</strong> rectangles = [[1,1,3,3],[3,1,4,2],[1,3,2,4],[2,2,4,4]]
<strong>Output:</strong> false
<strong>Explanation:</strong> Because two of the rectangles overlap with each other.
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>1 &lt;= rectangles.length &lt;= 2 * 10<sup>4</sup></code></li>
	<li><code>rectangles[i].length == 4</code></li>
	<li><code>-10<sup>5</sup> &lt;= x<sub>i</sub>, y<sub>i</sub>, a<sub>i</sub>, b<sub>i</sub> &lt;= 10<sup>5</sup></code></li>
</ul>
</div>

## ä¸­æ–‡é¢˜ç›®
<div><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ <code>rectangles</code> ï¼Œå…¶ä¸­ <code>rectangles[i] = [x<sub>i</sub>, y<sub>i</sub>, a<sub>i</sub>, b<sub>i</sub>]</code> è¡¨ç¤ºä¸€ä¸ªåæ ‡è½´å¹³è¡Œçš„çŸ©å½¢ã€‚è¿™ä¸ªçŸ©å½¢çš„å·¦ä¸‹é¡¶ç‚¹æ˜¯ <code>(x<sub>i</sub>, y<sub>i</sub>)</code> ï¼Œå³ä¸Šé¡¶ç‚¹æ˜¯ <code>(a<sub>i</sub>, b<sub>i</sub>)</code> ã€‚</p>

<p>å¦‚æœæ‰€æœ‰çŸ©å½¢ä¸€èµ·ç²¾ç¡®è¦†ç›–äº†æŸä¸ªçŸ©å½¢åŒºåŸŸï¼Œåˆ™è¿”å› <code>true</code> ï¼›å¦åˆ™ï¼Œè¿”å› <code>false</code> ã€‚</p>
&nbsp;

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perectrec1-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>rectangles = [[1,1,3,3],[3,1,4,2],[3,2,4,4],[1,3,2,4],[2,3,3,4]]
<strong>è¾“å‡ºï¼š</strong>true
<strong>è§£é‡Šï¼š</strong>5 ä¸ªçŸ©å½¢ä¸€èµ·å¯ä»¥ç²¾ç¡®åœ°è¦†ç›–ä¸€ä¸ªçŸ©å½¢åŒºåŸŸã€‚ 
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perfectrec2-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>rectangles = [[1,1,2,3],[1,3,2,4],[3,1,4,2],[3,2,4,4]]
<strong>è¾“å‡ºï¼š</strong>false
<strong>è§£é‡Šï¼š</strong>ä¸¤ä¸ªçŸ©å½¢ä¹‹é—´æœ‰é—´éš”ï¼Œæ— æ³•è¦†ç›–æˆä¸€ä¸ªçŸ©å½¢ã€‚</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perfectrec3-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>rectangles = [[1,1,3,3],[3,1,4,2],[1,3,2,4],[3,2,4,4]]
<strong>è¾“å‡ºï¼š</strong>false
<strong>è§£é‡Šï¼š</strong>å›¾å½¢é¡¶ç«¯ç•™æœ‰ç©ºç¼ºï¼Œæ— æ³•è¦†ç›–æˆä¸€ä¸ªçŸ©å½¢ã€‚</pre>

<p><strong>ç¤ºä¾‹ 4ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/03/27/perfecrrec4-plane.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>rectangles = [[1,1,3,3],[3,1,4,2],[1,3,2,4],[2,2,4,4]]
<strong>è¾“å‡ºï¼š</strong>false
<strong>è§£é‡Šï¼š</strong>å› ä¸ºä¸­é—´æœ‰ç›¸äº¤åŒºåŸŸï¼Œè™½ç„¶å½¢æˆäº†çŸ©å½¢ï¼Œä½†ä¸æ˜¯ç²¾ç¡®è¦†ç›–ã€‚</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= rectangles.length &lt;= 2 * 10<sup>4</sup></code></li>
	<li><code>rectangles[i].length == 4</code></li>
	<li><code>-10<sup>5</sup> &lt;= x<sub>i</sub>, y<sub>i</sub>, a<sub>i</sub>, b<sub>i</sub> &lt;= 10<sup>5</sup></code></li>
</ul>
</div>

## é€šè¿‡ä»£ç 
<RecoDemo>
</RecoDemo>


## é«˜èµé¢˜è§£
## æ‰«æçº¿

å°†æ¯ä¸ªçŸ©å½¢ $rectangles[i]$ çœ‹åšä¸¤æ¡ç«–ç›´æ–¹å‘çš„è¾¹ï¼Œä½¿ç”¨ $(x, y1, y2)$ çš„å½¢å¼è¿›è¡Œå­˜å‚¨ï¼ˆå…¶ä¸­ $y1$ ä»£è¡¨è¯¥ç«–è¾¹çš„ä¸‹ç«¯ç‚¹ï¼Œ$y2$ ä»£è¡¨ç«–è¾¹çš„ä¸Šç«¯ç‚¹ï¼‰ï¼ŒåŒæ—¶ä¸ºäº†åŒºåˆ†æ˜¯çŸ©å½¢çš„å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼Œå†å¼•å…¥ä¸€ä¸ªæ ‡è¯†ä½ï¼Œå³ä»¥å››å…ƒç»„ $(x, y1, y2, flag)$ çš„å½¢å¼è¿›è¡Œå­˜å‚¨ã€‚

ä¸€ä¸ªå®Œç¾çŸ©å½¢çš„å……è¦æ¡ä»¶ä¸ºï¼š**å¯¹äºå®Œç¾çŸ©å½¢çš„æ¯ä¸€æ¡éè¾¹ç¼˜çš„ç«–è¾¹ï¼Œéƒ½ã€Œæˆå¯¹ã€å‡ºç°ï¼ˆå­˜åœ¨ä¸¤æ¡å®Œå…¨ç›¸åŒçš„å·¦è¾¹å’Œå³è¾¹é‡å åœ¨ä¸€èµ·ï¼‰ï¼›å¯¹äºå®Œç¾çŸ©å½¢çš„ä¸¤æ¡è¾¹ç¼˜ç«–è¾¹ï¼Œå‡ç‹¬ç«‹ä¸ºä¸€æ¡è¿ç»­çš„ï¼ˆä¸é‡å ï¼‰çš„ç«–è¾¹ã€‚**

å¦‚å›¾ï¼ˆçº¢è‰²æ¡†çš„ä¸ºã€Œå®Œç¾çŸ©å½¢çš„è¾¹ç¼˜ç«–è¾¹ã€ï¼Œç»¿æ¡†çš„ä¸ºã€Œå®Œç¾çŸ©å½¢çš„éè¾¹ç¼˜ç«–è¾¹ã€ï¼‰ï¼š

![image.png](../images/perfect-rectangle-0.png)

* ç»¿è‰²ï¼šéè¾¹ç¼˜ç«–è¾¹å¿…ç„¶æœ‰æˆå¯¹çš„å·¦å³ä¸¤æ¡å®Œå…¨ç›¸åŒçš„ç«–è¾¹é‡å åœ¨ä¸€èµ·ï¼›
* çº¢è‰²ï¼šè¾¹ç¼˜ç«–è¾¹ç”±äºåªæœ‰å•è¾¹ï¼Œå¿…ç„¶ä¸é‡å ï¼Œä¸”è¿æ¥æˆä¸€æ¡å®Œæˆçš„ç«–è¾¹ã€‚

![image.png](../images/perfect-rectangle-1.png)

**ä»£ç ï¼ˆæ„Ÿè°¢ [@ricecake](/u/ricecake-5/) åŒå­¦æä¾›çš„ Python3 ä»£ç ï¼‰ï¼š**
```Java []
class Solution {
    public boolean isRectangleCover(int[][] rectangles) {
        int n = rectangles.length;
        int[][] rs = new int[n * 2][4];
        for (int i = 0, idx = 0; i < n; i++) {
            int[] re = rectangles[i];
            rs[idx++] = new int[]{re[0], re[1], re[3], 1};
            rs[idx++] = new int[]{re[2], re[1], re[3], -1};
        }
        Arrays.sort(rs, (a,b)->{
            if (a[0] != b[0]) return a[0] - b[0];
            return a[1] - b[1];
        });
        n *= 2;
        // åˆ†åˆ«å­˜å‚¨ç›¸åŒçš„æ¨ªåæ ‡ä¸‹ã€Œå·¦è¾¹çš„çº¿æ®µã€å’Œã€Œå³è¾¹çš„çº¿æ®µã€ (y1, y2)
        List<int[]> l1 = new ArrayList<>(), l2 = new ArrayList<>(); 
        for (int l = 0; l < n; ) {
            int r = l;
            l1.clear(); l2.clear();
            // æ‰¾åˆ°æ¨ªåæ ‡ç›¸åŒéƒ¨åˆ†
            while (r < n && rs[r][0] == rs[l][0]) r++;
            for (int i = l; i < r; i++) {
                int[] cur = new int[]{rs[i][1], rs[i][2]};
                List<int[]> list = rs[i][3] == 1 ? l1 : l2;
                if (list.isEmpty()) {
                    list.add(cur);
                } else {
                    int[] prev = list.get(list.size() - 1);
                    if (cur[0] < prev[1]) return false; // å­˜åœ¨é‡å 
                    else if (cur[0] == prev[1]) prev[1] = cur[1]; // é¦–å°¾ç›¸è¿
                    else list.add(cur); 
                }
            }
            if (l > 0 && r < n) {
                // è‹¥ä¸æ˜¯å®Œç¾çŸ©å½¢çš„è¾¹ç¼˜ç«–è¾¹ï¼Œæ£€æŸ¥æ˜¯å¦æˆå¯¹å‡ºç°
                if (l1.size() != l2.size()) return false;
                for (int i = 0; i < l1.size(); i++) {
                    if (l1.get(i)[0] == l2.get(i)[0] && l1.get(i)[1] == l2.get(i)[1]) continue;
                    return false;
                }
            } else {
                // è‹¥æ˜¯å®Œç¾çŸ©å½¢çš„è¾¹ç¼˜ç«–è¾¹ï¼Œæ£€æŸ¥æ˜¯å¦å½¢æˆå®Œæ•´ä¸€æ®µ
                if (l1.size() + l2.size() != 1) return false;
            }
            l = r;
        }
        return true;
    }
}
```
```Python3 []
class Solution:
    def isRectangleCover(self, rectangles: List[List[int]]) -> bool:
        if not rectangles:
            return False
        n = len(rectangles)
        # è§£ææ•°æ®ï¼Œ(x, y, a, b) -> (x, y, b, 1) ï¼Œ(a, y, b, -1)
        # æœ€åä¸€ä½è¡¨ç¤ºæ˜¯çŸ©å½¢çš„å·¦è¾¹ç¼˜è¿˜æ˜¯å³è¾¹ç¼˜ï¼ˆå³æ‰«æçº¿çš„â€œä¸Šå‡â€å’Œâ€œä¸‹é™â€ï¼‰
        rs = []
        for rec in rectangles:
            x, y, a, b = rec
            rs.append([x, y, b, 1])
            rs.append([a, y, b, -1])
        rs.sort()
        
        l = r = 0
        while r < len(rs):
            l1 = [] # è®°å½•â€œä¸Šå‡â€çš„çº¿æ®µ
            l2 = [] # è®°å½•â€œä¸‹é™â€çš„çº¿æ®µ
            while r < len(rs) and rs[r][0] == rs[l][0]:
                r += 1
            for i in range(l, r): # éå†æ¨ªåæ ‡ç›¸åŒçš„çº¿æ®µ
                x, y1, y2, isUp = rs[i]
                curl = l1 if isUp == 1 else l2 
                if not curl:
                    curl.append([y1, y2])
                else:
                    if curl[-1][1] > y1: # æœ‰é‡å 
                        return False 
                    elif curl[-1][1] == y1: # èƒ½è¿æ¥ä¸Šï¼Œè¿›è¡Œè¿æ¥
                        curl[-1][1] = y2 
                    else: # ä¸èƒ½è¿æ¥ä¸Šï¼Œè®°å½•æ–°çš„ä¸€æ®µ
                        curl.append([y1, y2])
            # è‹¥å¤„ç†çš„æ˜¯æœ€å·¦è¾¹çš„è¾¹æˆ–æœ€å³è¾¹çš„è¾¹ï¼Œæ­¤æ—¶åº”è¿æˆä¸€ä¸ªçº¿æ®µ
            if l == 0 or r == len(rs): 
                if len(l1) + len(l2) != 1:
                    return False 
            else:
                # è‹¥å¤„ç†çš„æ˜¯ä¸­é—´çš„æ‰«æçº¿ï¼Œæ­¤æ—¶ä¸Šå‡çš„çº¿æ®µå’Œä¸‹é™çš„çº¿æ®µåº”å®Œå…¨ç›¸åŒæ‰èƒ½æ­£å¥½é‡å 
                if len(l1) != len(l2):
                    return False 
                for i in range(len(l1)):
                    if l1[i] != l2[i]:
                        return False 
            l = r # è¿›å…¥ä¸‹ä¸€ä¸ªæ¨ªåæ ‡çš„æ‰«æ
        return True
```
* æ—¶é—´å¤æ‚åº¦ï¼šå°† `rectangles` åˆ’åˆ†æˆè¾¹é›†çš„å¤æ‚åº¦ä¸º $O(n)$ï¼›å¯¹è¾¹é›†è¿›è¡Œæ’åºçš„å¤æ‚åº¦ä¸º $O(n\log{n})$ï¼Œå¯¹æ’åºå¥½çš„è¾¹é›†è¿›è¡Œéå†æ£€æŸ¥ï¼Œæ¯æ¡è¾¹ä¼šè¢«æ‰«æçº¿æ€§æ¬¡ï¼Œå¤æ‚åº¦ä¸º $O(n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(n\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## å…¶ä»–ã€Œæ‰«æçº¿ã€é—®é¢˜

è€ƒè™‘åŠ ç»ƒå¦‚ä¸‹ã€Œæ‰«æçº¿ã€é—®é¢˜ ğŸ­ğŸ­ğŸ­

| é¢˜ç›®                                                         | é¢˜è§£                                                         | éš¾åº¦ | æ¨èæŒ‡æ•° |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ---- | -------- |
| [218. å¤©é™…çº¿é—®é¢˜](https://leetcode-cn.com/problems/the-skyline-problem/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/the-skyline-problem/solution/gong-shui-san-xie-sao-miao-xian-suan-fa-0z6xc/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©      |
| [391. å®Œç¾çŸ©å½¢](https://leetcode-cn.com/problems/perfect-rectangle/) | [LeetCode é¢˜è§£é“¾æ¥](https://leetcode-cn.com/problems/perfect-rectangle/solution/gong-shui-san-xie-chang-gui-sao-miao-xia-p4q4/) | å›°éš¾ | ğŸ¤©ğŸ¤©ğŸ¤©ğŸ¤©     |


**æ³¨ï¼šä»¥ä¸Šç›®å½•æ•´ç†æ¥è‡ª [wiki](https://github.com/SharingSource/LogicStack-LeetCode/wiki/æ‰«æçº¿)ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½å¼•ç”¨è¯·ä¿ç•™å‡ºå¤„ã€‚**

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png)ï¼ˆå…¬ä¸»å·åå°å›å¤ã€Œé€ä¹¦ã€å³å¯å‚ä¸é•¿æœŸçœ‹é¢˜è§£å­¦ç®—æ³•é€å®ä½“ä¹¦æ´»åŠ¨ï¼‰æˆ– åŠ å…¥[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~ 

## ç»Ÿè®¡ä¿¡æ¯
| é€šè¿‡æ¬¡æ•° | æäº¤æ¬¡æ•° | ACæ¯”ç‡ |
| :------: | :------: | :------: |
|    21395    |    45626    |   46.9%   |

## æäº¤å†å²
| æäº¤æ—¶é—´ | æäº¤ç»“æœ | æ‰§è¡Œæ—¶é—´ |  å†…å­˜æ¶ˆè€—  | è¯­è¨€ |
| :------: | :------: | :------: | :--------: | :--------: |
