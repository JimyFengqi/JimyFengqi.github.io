---
title: 218-å¤©é™…çº¿é—®é¢˜(The Skyline Problem)
categories:
  - å›°éš¾
tags:
  - æ ‘çŠ¶æ•°ç»„
  - çº¿æ®µæ ‘
  - æ•°ç»„
  - åˆ†æ²»
  - æœ‰åºé›†åˆ
  - æ‰«æçº¿
  - å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰
abbrlink: 253901480
date: 2021-12-03 22:52:35
---

> åŸæ–‡é“¾æ¥: https://leetcode-cn.com/problems/the-skyline-problem


## è‹±æ–‡åŸæ–‡
<div><p>A city&#39;s <strong>skyline</strong> is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance. Given the locations and heights of all the buildings, return <em>the <strong>skyline</strong> formed by these buildings collectively</em>.</p>

<p>The geometric information of each building is given in the array <code>buildings</code> where <code>buildings[i] = [left<sub>i</sub>, right<sub>i</sub>, height<sub>i</sub>]</code>:</p>

<ul>
	<li><code>left<sub>i</sub></code> is the x coordinate of the left edge of the <code>i<sup>th</sup></code> building.</li>
	<li><code>right<sub>i</sub></code> is the x coordinate of the right edge of the <code>i<sup>th</sup></code> building.</li>
	<li><code>height<sub>i</sub></code> is the height of the <code>i<sup>th</sup></code> building.</li>
</ul>

<p>You may assume all buildings are perfect rectangles grounded on an absolutely flat surface at height <code>0</code>.</p>

<p>The <strong>skyline</strong> should be represented as a list of &quot;key points&quot; <strong>sorted by their x-coordinate</strong> in the form <code>[[x<sub>1</sub>,y<sub>1</sub>],[x<sub>2</sub>,y<sub>2</sub>],...]</code>. Each key point is the left endpoint of some horizontal segment in the skyline except the last point in the list, which always has a y-coordinate <code>0</code> and is used to mark the skyline&#39;s termination where the rightmost building ends. Any ground between the leftmost and rightmost buildings should be part of the skyline&#39;s contour.</p>

<p><b>Note:</b> There must be no consecutive horizontal lines of equal height in the output skyline. For instance, <code>[...,[2 3],[4 5],[7 5],[11 5],[12 7],...]</code> is not acceptable; the three lines of height 5 should be merged into one in the final output as such: <code>[...,[2 3],[4 5],[12 7],...]</code></p>

<p>&nbsp;</p>
<p><strong>Example 1:</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2020/12/01/merged.jpg" style="width: 800px; height: 331px;" />
<pre>
<strong>Input:</strong> buildings = [[2,9,10],[3,7,15],[5,12,12],[15,20,10],[19,24,8]]
<strong>Output:</strong> [[2,10],[3,15],[7,12],[12,0],[15,10],[20,8],[24,0]]
<strong>Explanation:</strong>
Figure A shows the buildings of the input.
Figure B shows the skyline formed by those buildings. The red points in figure B represent the key points in the output list.
</pre>

<p><strong>Example 2:</strong></p>

<pre>
<strong>Input:</strong> buildings = [[0,2,3],[2,5,3]]
<strong>Output:</strong> [[0,3],[5,0]]
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>1 &lt;= buildings.length &lt;= 10<sup>4</sup></code></li>
	<li><code>0 &lt;= left<sub>i</sub> &lt; right<sub>i</sub> &lt;= 2<sup>31</sup> - 1</code></li>
	<li><code>1 &lt;= height<sub>i</sub> &lt;= 2<sup>31</sup> - 1</code></li>
	<li><code>buildings</code> is sorted by <code>left<sub>i</sub></code> in&nbsp;non-decreasing order.</li>
</ul>
</div>

## ä¸­æ–‡é¢˜ç›®
<div><p>åŸå¸‚çš„å¤©é™…çº¿æ˜¯ä»è¿œå¤„è§‚çœ‹è¯¥åŸå¸‚ä¸­æ‰€æœ‰å»ºç­‘ç‰©å½¢æˆçš„è½®å»“çš„å¤–éƒ¨è½®å»“ã€‚ç»™ä½ æ‰€æœ‰å»ºç­‘ç‰©çš„ä½ç½®å’Œé«˜åº¦ï¼Œè¯·è¿”å›ç”±è¿™äº›å»ºç­‘ç‰©å½¢æˆçš„<strong> å¤©é™…çº¿</strong> ã€‚</p>

<p>æ¯ä¸ªå»ºç­‘ç‰©çš„å‡ ä½•ä¿¡æ¯ç”±æ•°ç»„ <code>buildings</code> è¡¨ç¤ºï¼Œå…¶ä¸­ä¸‰å…ƒç»„ <code>buildings[i] = [lefti, righti, heighti]</code> è¡¨ç¤ºï¼š</p>

<ul>
	<li><code>left<sub>i</sub></code> æ˜¯ç¬¬ <code>i</code> åº§å»ºç­‘ç‰©å·¦è¾¹ç¼˜çš„ <code>x</code> åæ ‡ã€‚</li>
	<li><code>right<sub>i</sub></code> æ˜¯ç¬¬ <code>i</code> åº§å»ºç­‘ç‰©å³è¾¹ç¼˜çš„ <code>x</code> åæ ‡ã€‚</li>
	<li><code>height<sub>i</sub></code> æ˜¯ç¬¬ <code>i</code> åº§å»ºç­‘ç‰©çš„é«˜åº¦ã€‚</li>
</ul>

<p><strong>å¤©é™…çº¿</strong> åº”è¯¥è¡¨ç¤ºä¸ºç”± â€œå…³é”®ç‚¹â€ ç»„æˆçš„åˆ—è¡¨ï¼Œæ ¼å¼ <code>[[x<sub>1</sub>,y<sub>1</sub>],[x<sub>2</sub>,y<sub>2</sub>],...]</code> ï¼Œå¹¶æŒ‰ <strong>x åæ ‡ </strong>è¿›è¡Œ <strong>æ’åº</strong> ã€‚<strong>å…³é”®ç‚¹æ˜¯æ°´å¹³çº¿æ®µçš„å·¦ç«¯ç‚¹</strong>ã€‚åˆ—è¡¨ä¸­æœ€åä¸€ä¸ªç‚¹æ˜¯æœ€å³ä¾§å»ºç­‘ç‰©çš„ç»ˆç‚¹ï¼Œ<code>y</code> åæ ‡å§‹ç»ˆä¸º <code>0</code> ï¼Œä»…ç”¨äºæ ‡è®°å¤©é™…çº¿çš„ç»ˆç‚¹ã€‚æ­¤å¤–ï¼Œä»»ä½•ä¸¤ä¸ªç›¸é‚»å»ºç­‘ç‰©ä¹‹é—´çš„åœ°é¢éƒ½åº”è¢«è§†ä¸ºå¤©é™…çº¿è½®å»“çš„ä¸€éƒ¨åˆ†ã€‚</p>

<p><strong>æ³¨æ„ï¼š</strong>è¾“å‡ºå¤©é™…çº¿ä¸­ä¸å¾—æœ‰è¿ç»­çš„ç›¸åŒé«˜åº¦çš„æ°´å¹³çº¿ã€‚ä¾‹å¦‚ <code>[...[2 3], [4 5], [7 5], [11 5], [12 7]...]</code> æ˜¯ä¸æ­£ç¡®çš„ç­”æ¡ˆï¼›ä¸‰æ¡é«˜åº¦ä¸º 5 çš„çº¿åº”è¯¥åœ¨æœ€ç»ˆè¾“å‡ºä¸­åˆå¹¶ä¸ºä¸€ä¸ªï¼š<code>[...[2 3], [4 5], [12 7], ...]</code></p>

<p>Â </p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2020/12/01/merged.jpg" style="width: 800px; height: 331px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>buildings = [[2,9,10],[3,7,15],[5,12,12],[15,20,10],[19,24,8]]
<strong>è¾“å‡ºï¼š</strong>[[2,10],[3,15],[7,12],[12,0],[15,10],[20,8],[24,0]]
<strong>è§£é‡Šï¼š</strong>
å›¾ A<strong> </strong>æ˜¾ç¤ºè¾“å…¥çš„æ‰€æœ‰å»ºç­‘ç‰©çš„ä½ç½®å’Œé«˜åº¦ï¼Œ
å›¾ B æ˜¾ç¤ºç”±è¿™äº›å»ºç­‘ç‰©å½¢æˆçš„å¤©é™…çº¿ã€‚å›¾ B ä¸­çš„çº¢ç‚¹è¡¨ç¤ºè¾“å‡ºåˆ—è¡¨ä¸­çš„å…³é”®ç‚¹ã€‚</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>buildings = [[0,2,3],[2,5,3]]
<strong>è¾“å‡ºï¼š</strong>[[0,3],[5,0]]
</pre>

<p>Â </p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 <= buildings.length <= 10<sup>4</sup></code></li>
	<li><code>0 <= left<sub>i</sub> < right<sub>i</sub> <= 2<sup>31</sup> - 1</code></li>
	<li><code>1 <= height<sub>i</sub> <= 2<sup>31</sup> - 1</code></li>
	<li><code>buildings</code> æŒ‰ <code>left<sub>i</sub></code> éé€’å‡æ’åº</li>
</ul>
</div>

## é€šè¿‡ä»£ç 
<RecoDemo>
</RecoDemo>


## é«˜èµé¢˜è§£
## åŸºæœ¬åˆ†æ

è¿™æ˜¯ä¸€é¢˜ç‰¹åˆ«çš„æ‰«æçº¿é—®é¢˜ ğŸ¤£ğŸ¤£ğŸ¤£

æ—¢ä¸æ˜¯æ±‚å‘¨é•¿ï¼Œä¹Ÿä¸æ˜¯æ±‚é¢ç§¯ï¼Œæ˜¯æ±‚è½®å»“ä¸­çš„æ‰€æœ‰çš„æ°´å¹³çº¿çš„å·¦ç«¯ç‚¹ ğŸ¤£ğŸ¤£ğŸ¤£

æ‰€ä»¥è¿™ä¸æ˜¯ä¸€é“å¿…é¡»ç”¨ã€Œçº¿æ®µæ ‘ã€æ¥è§£å†³çš„æ‰«æçº¿é—®é¢˜ï¼ˆå› ä¸ºä¸éœ€è¦è€ƒè™‘åŒºé—´æŸ¥è¯¢é—®é¢˜ï¼‰ã€‚

æ‰«æçº¿çš„æ ¸å¿ƒåœ¨äº **å°†ä¸è§„åˆ™çš„å½¢çŠ¶æŒ‰ç…§æ°´å¹³æˆ–è€…å‚ç›´çš„æ–¹å¼ï¼Œåˆ’åˆ†æˆè‹¥å¹²ä¸ªè§„åˆ™çš„çŸ©å½¢ã€‚**

---

## æ‰«æçº¿

å¯¹äºæœ¬é¢˜ï¼Œå¯¹åº”çš„æ‰«æçº¿åˆ†å‰²å½¢çŠ¶å¦‚å›¾ï¼š

![image.png](../images/the-skyline-problem-0.png)

ä¸éš¾å‘ç°ï¼Œç”±ç›¸é‚»ä¸¤ä¸ªæ¨ªåæ ‡ä»¥åŠæœ€å¤§é«˜åº¦ï¼Œå¯ä»¥ç¡®å®šä¸€ä¸ªçŸ©å½¢ã€‚

é¢˜ç›®è¦æˆ‘ä»¬ **è¾“å‡ºæ¯ä¸ªçŸ©å½¢çš„â€œä¸Šè¾¹â€çš„å·¦ç«¯ç‚¹ï¼ŒåŒæ—¶è·³è¿‡å¯ç”±å‰ä¸€çŸ©å½¢â€œä¸Šè¾¹â€å»¶å±•è€Œæ¥çš„é‚£äº›è¾¹ã€‚**

å› æ­¤æˆ‘ä»¬éœ€è¦å®æ—¶ç»´æŠ¤ä¸€ä¸ªæœ€å¤§é«˜åº¦ï¼Œå¯ä»¥ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ã€‚

å®ç°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®°å½•ä¸‹ $buildings$ ä¸­æ‰€æœ‰çš„å·¦å³ç«¯ç‚¹æ¨ªåæ ‡åŠé«˜åº¦ï¼Œå¹¶æ ¹æ®ç«¯ç‚¹æ¨ªåæ ‡è¿›è¡Œä»å°åˆ°å¤§æ’åºã€‚

åœ¨ä»å‰å¾€åéå†å¤„ç†æ—¶ï¼ˆéå†æ¯ä¸ªçŸ©å½¢ï¼‰ï¼Œæ ¹æ®å½“å‰éå†åˆ°çš„ç‚¹è¿›è¡Œåˆ†æƒ…å†µè®¨è®ºï¼š

* å·¦ç«¯ç‚¹ï¼šå› ä¸ºæ˜¯å·¦ç«¯ç‚¹ï¼Œå¿…ç„¶å­˜åœ¨ä¸€æ¡ä»å³å»¶å±•çš„è¾¹ï¼Œä½†ä¸ä¸€å®šæ˜¯éœ€è¦è¢«è®°å½•çš„è¾¹ï¼Œå› ä¸ºåœ¨åŒä¸€çŸ©å½¢ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦è®°å½•æœ€ä¸Šè¾¹çš„è¾¹ã€‚è¿™æ—¶å€™å¯ä»¥å°†é«˜åº¦è¿›è¡Œå…¥é˜Ÿï¼›

* å³ç«¯ç‚¹ï¼šæ­¤æ—¶æ„å‘³ç€ä¹‹å‰æŸä¸€æ¡å¾€å³å»¶å±•çš„çº¿ç»“æŸäº†ï¼Œè¿™æ—¶å€™éœ€è¦å°†é«˜åº¦å‡ºé˜Ÿï¼ˆä»£è¡¨è¿™ç»“æŸçš„çº¿ä¸è¢«è€ƒè™‘ï¼‰ã€‚

ç„¶åä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­å–å‡ºå½“å‰çš„æœ€å¤§é«˜åº¦ï¼Œä¸ºäº†é˜²æ­¢å½“å‰çš„çº¿ä¸å‰ä¸€çŸ©å½¢â€œä¸Šè¾¹â€å»¶å±•è€Œæ¥çš„çº¿é‡åˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªå˜é‡ `prev` è®°å½•ä¸Šä¸€ä¸ªè®°å½•çš„é«˜åº¦ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    public List<List<Integer>> getSkyline(int[][] bs) {
        List<List<Integer>> ans = new ArrayList<>();
        
        // é¢„å¤„ç†æ‰€æœ‰çš„ç‚¹ï¼Œä¸ºäº†æ–¹ä¾¿æ’åºï¼Œå¯¹äºå·¦ç«¯ç‚¹ï¼Œä»¤é«˜åº¦ä¸ºè´Ÿï¼›å¯¹äºå³ç«¯ç‚¹ä»¤é«˜åº¦ä¸ºæ­£
        List<int[]> ps = new ArrayList<>();
        for (int[] b : bs) {
            int l = b[0], r = b[1], h = b[2];
            ps.add(new int[]{l, -h});
            ps.add(new int[]{r, h});
        }

        // å…ˆæŒ‰ç…§æ¨ªåæ ‡è¿›è¡Œæ’åº
        // å¦‚æœæ¨ªåæ ‡ç›¸åŒï¼Œåˆ™æŒ‰ç…§å·¦ç«¯ç‚¹æ’åº
        // å¦‚æœç›¸åŒçš„å·¦/å³ç«¯ç‚¹ï¼Œåˆ™æŒ‰ç…§é«˜åº¦è¿›è¡Œæ’åº
        Collections.sort(ps, (a, b)->{
            if (a[0] != b[0]) return a[0] - b[0];
            return a[1] - b[1];
        });
        
        // å¤§æ ¹å †
        PriorityQueue<Integer> q = new PriorityQueue<>((a,b)->b-a);
        int prev = 0;
        q.add(prev);
        for (int[] p : ps) {
            int point = p[0], height = p[1];
            if (height < 0) {
                // å¦‚æœæ˜¯å·¦ç«¯ç‚¹ï¼Œè¯´æ˜å­˜åœ¨ä¸€æ¡å¾€å³å»¶ä¼¸çš„å¯è®°å½•çš„è¾¹ï¼Œå°†é«˜åº¦å­˜å…¥ä¼˜å…ˆé˜Ÿåˆ—
                q.add(-height);
            } else {
                // å¦‚æœæ˜¯å³ç«¯ç‚¹ï¼Œè¯´æ˜è¿™æ¡è¾¹ç»“æŸäº†ï¼Œå°†å½“å‰é«˜åº¦ä»é˜Ÿåˆ—ä¸­ç§»é™¤
                q.remove(height);
            }

            // å–å‡ºæœ€é«˜é«˜åº¦ï¼Œå¦‚æœå½“å‰ä¸ä¸å‰ä¸€çŸ©å½¢â€œä¸Šè¾¹â€å»¶å±•è€Œæ¥çš„é‚£äº›è¾¹é‡åˆï¼Œåˆ™å¯ä»¥è¢«è®°å½•
            int cur = q.peek();
            if (cur != prev) {
                List<Integer> list = new ArrayList<>();
                list.add(point);
                list.add(cur);
                ans.add(list);
                prev = cur;
            }
        }
        return ans;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šéœ€è¦å¤„ç†çš„çŸ©é˜µæ•°é‡ä¸ $n$ æ­£æ¯”ï¼Œæ¯ä¸ªçŸ©é˜µéœ€è¦ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤é«˜åº¦ï¼Œå…¶ä¸­ `remove` æ“ä½œéœ€è¦å…ˆèŠ±è´¹ $O(n)$ å¤æ‚åº¦è¿›è¡ŒæŸ¥æ‰¾ï¼Œç„¶åé€šè¿‡ $O(\log{n})$ å¤æ‚åº¦è¿›è¡Œç§»é™¤ï¼Œå¤æ‚åº¦ä¸º $O(n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(n^2)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## ç­”ç–‘

**1. å°†å·¦ç«¯ç‚¹çš„é«˜åº¦å­˜æˆè´Ÿæ•°å†è¿›è¡Œæ’åºæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ**

è¿™é‡Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œæ‰€ä»¥é‡‡å–äº†è¿™æ ·çš„åšæ³•ï¼Œå½“ç„¶ä¹Ÿèƒ½å¤Ÿå¤šä½¿ç”¨ä¸€ä½æ¥ä»£æŒ‡ã€Œå·¦å³ã€ã€‚

åªè¦æœ€ç»ˆå¯ä»¥è¾¾åˆ°å¦‚ä¸‹çš„æ’åºè§„åˆ™å³å¯ï¼š

1. å…ˆä¸¥æ ¼æŒ‰ç…§æ¨ªåæ ‡è¿›è¡Œã€Œä»å°åˆ°å¤§ã€æ’åº
2. å¯¹äºæŸä¸ªæ¨ªåæ ‡è€Œè¨€ï¼Œå¯èƒ½ä¼šåŒæ—¶å‡ºç°å¤šä¸ªç‚¹ï¼Œåº”å½“æŒ‰ç…§å¦‚ä¸‹è§„åˆ™è¿›è¡Œå¤„ç†ï¼š
    1. ä¼˜å…ˆå¤„ç†å·¦ç«¯ç‚¹ï¼Œå†å¤„ç†å³ç«¯ç‚¹
    2. å¦‚æœåŒæ ·éƒ½æ˜¯å·¦ç«¯ç‚¹ï¼Œåˆ™æŒ‰ç…§é«˜åº¦ã€Œä»å¤§åˆ°å°ã€è¿›è¡Œå¤„ç†ï¼ˆå°†é«˜åº¦å¢åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼‰
    3. å¦‚æœåŒæ ·éƒ½æ˜¯å³ç«¯ç‚¹ï¼Œåˆ™æŒ‰ç…§é«˜åº¦ã€Œä»å°åˆ°å¤§ã€è¿›è¡Œå¤„ç†ï¼ˆå°†é«˜åº¦ä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­åˆ æ‰ï¼‰

ä»£ç ï¼š
```Java []
class Solution {
    public List<List<Integer>> getSkyline(int[][] bs) {
        List<List<Integer>> ans = new ArrayList<>();
        List<int[]> ps = new ArrayList<>();
        for (int[] b : bs) {
            int l = b[0], r = b[1], h = b[2];
            ps.add(new int[]{l, h, -1});
            ps.add(new int[]{r, h, 1});
        }
        /**
         * å…ˆä¸¥æ ¼æŒ‰ç…§æ¨ªåæ ‡è¿›è¡Œã€Œä»å°åˆ°å¤§ã€æ’åº
         * å¯¹äºæŸä¸ªæ¨ªåæ ‡è€Œè¨€ï¼Œå¯èƒ½ä¼šåŒæ—¶å‡ºç°å¤šä¸ªç‚¹ï¼Œåº”å½“æŒ‰ç…§å¦‚ä¸‹è§„åˆ™è¿›è¡Œå¤„ç†ï¼š
         * 1. ä¼˜å…ˆå¤„ç†å·¦ç«¯ç‚¹ï¼Œå†å¤„ç†å³ç«¯ç‚¹
         * 2. å¦‚æœåŒæ ·éƒ½æ˜¯å·¦ç«¯ç‚¹ï¼Œåˆ™æŒ‰ç…§é«˜åº¦ã€Œä»å¤§åˆ°å°ã€è¿›è¡Œå¤„ç†ï¼ˆå°†é«˜åº¦å¢åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼‰
         * 3. å¦‚æœåŒæ ·éƒ½æ˜¯å³ç«¯ç‚¹ï¼Œåˆ™æŒ‰ç…§é«˜åº¦ã€Œä»å°åˆ°å¤§ã€è¿›è¡Œå¤„ç†ï¼ˆå°†é«˜åº¦ä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­åˆ æ‰ï¼‰
         */
        Collections.sort(ps, (a, b)->{
            if (a[0] != b[0]) return a[0] - b[0];
            if (a[2] != b[2]) return a[2] - b[2];
            if (a[2] == -1) {
                return b[1] - a[1];
            } else {
                return a[1] - b[1];
            }
        });
        PriorityQueue<Integer> q = new PriorityQueue<>((a,b)->b-a);
        int prev = 0;
        q.add(prev);
        for (int[] p : ps) {
            int point = p[0], height = p[1], flag = p[2];
            if (flag == -1) {
                q.add(height);
            } else {
                q.remove(height);
            }

            int cur = q.peek();
            if (cur != prev) {
                List<Integer> list = new ArrayList<>();
                list.add(point);
                list.add(cur);
                ans.add(list);
                prev = cur;
            }
        }
        return ans;
    }
}
```

**2. ä¸ºä»€ä¹ˆåœ¨å¤„ç†å‰ï¼Œå…ˆå¾€ã€Œä¼˜å…ˆé˜Ÿåˆ—ã€æ·»åŠ ä¸€ä¸ª $0$ ï¼Ÿ**

å› ä¸ºé¢˜ç›®æœ¬èº«è¦æ±‚æˆ‘ä»¬æŠŠä¸€ä¸ªå®Œæ•´è½®å»“çš„ã€Œå³ä¸‹è§’ã€é‚£ä¸ªç‚¹ä¹Ÿå–åˆ°ï¼Œæ‰€ä»¥éœ€è¦å…ˆæ·»åŠ ä¸€ä¸ª $0$ã€‚

ä¹Ÿå°±æ˜¯ä¸‹å›¾è¢«åœˆå‡ºæ¥çš„é‚£äº›ç‚¹ï¼š

![image.png](../images/the-skyline-problem-1.png)

**3. ä¼˜å…ˆé˜Ÿåˆ—çš„ `remove` æ“ä½œæˆä¸ºäº†ç“¶é¢ˆï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ**

ç”±äºä¼˜å…ˆé˜Ÿåˆ—çš„ `remove` æ“ä½œéœ€è¦å…ˆç»è¿‡ $O(n)$ çš„å¤æ‚åº¦è¿›è¡ŒæŸ¥æ‰¾ï¼Œå†é€šè¿‡ $O(\log{n})$ çš„å¤æ‚åº¦è¿›è¡Œåˆ é™¤ã€‚å› æ­¤æ•´ä¸ª `remove` æ“ä½œçš„å¤æ‚åº¦æ˜¯ $O(n)$ çš„ï¼Œè¿™å¯¼è‡´äº†æˆ‘ä»¬ç®—æ³•æ•´ä½“å¤æ‚åº¦ä¸º $O(n^2)$ã€‚

ä¼˜åŒ–æ–¹å¼åŒ…æ‹¬ï¼šä½¿ç”¨åŸºäºçº¢é»‘æ ‘çš„ `TreeMap` ä»£æ›¿ä¼˜å…ˆé˜Ÿåˆ—ï¼›æˆ–æ˜¯ä½¿ç”¨ã€Œå“ˆå¸Œè¡¨ã€è®°å½•ã€Œæ‰§è¡Œäº†åˆ é™¤æ“ä½œçš„é«˜åº¦ã€åŠã€Œåˆ é™¤æ¬¡æ•°ã€ï¼Œåœ¨æ¯æ¬¡ä½¿ç”¨å‰å…ˆæ£€æŸ¥å †é¡¶é«˜åº¦æ˜¯å¦å·²ç»è¢«æ ‡è®°åˆ é™¤ï¼Œå¦‚æœæ˜¯åˆ™è¿›è¡Œ `poll` æ“ä½œï¼Œå¹¶æ›´æ–°åˆ é™¤æ¬¡æ•°ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªæ²¡è¢«åˆ é™¤çš„å †é¡¶é«˜åº¦ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    public List<List<Integer>> getSkyline(int[][] bs) {
        List<List<Integer>> ans = new ArrayList<>();
        List<int[]> ps = new ArrayList<>();
        for (int[] b : bs) {
            int l = b[0], r = b[1], h = b[2];
            ps.add(new int[]{l, h, -1});
            ps.add(new int[]{r, h, 1});
        }
        /**
         * å…ˆä¸¥æ ¼æŒ‰ç…§æ¨ªåæ ‡è¿›è¡Œã€Œä»å°åˆ°å¤§ã€æ’åº
         * å¯¹äºæŸä¸ªæ¨ªåæ ‡è€Œè¨€ï¼Œå¯èƒ½ä¼šåŒæ—¶å‡ºç°å¤šä¸ªç‚¹ï¼Œåº”å½“æŒ‰ç…§å¦‚ä¸‹è§„åˆ™è¿›è¡Œå¤„ç†ï¼š
         * 1. ä¼˜å…ˆå¤„ç†å·¦ç«¯ç‚¹ï¼Œå†å¤„ç†å³ç«¯ç‚¹
         * 2. å¦‚æœåŒæ ·éƒ½æ˜¯å·¦ç«¯ç‚¹ï¼Œåˆ™æŒ‰ç…§é«˜åº¦ã€Œä»å¤§åˆ°å°ã€è¿›è¡Œå¤„ç†ï¼ˆå°†é«˜åº¦å¢åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼‰
         * 3. å¦‚æœåŒæ ·éƒ½æ˜¯å³ç«¯ç‚¹ï¼Œåˆ™æŒ‰ç…§é«˜åº¦ã€Œä»å°åˆ°å¤§ã€è¿›è¡Œå¤„ç†ï¼ˆå°†é«˜åº¦ä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­åˆ æ‰ï¼‰
         */
        Collections.sort(ps, (a, b)->{
            if (a[0] != b[0]) return a[0] - b[0];
            if (a[2] != b[2]) return a[2] - b[2];
            if (a[2] == -1) {
                return b[1] - a[1];
            } else {
                return a[1] - b[1];
            }
        });
        // è®°å½•è¿›è¡Œäº†åˆ é™¤æ“ä½œçš„é«˜åº¦ï¼Œä»¥åŠåˆ é™¤æ¬¡æ•°
        Map<Integer, Integer> map = new HashMap<>();
        PriorityQueue<Integer> q = new PriorityQueue<>((a,b)->b-a);
        int prev = 0;
        q.add(prev);
        for (int[] p : ps) {
            int point = p[0], height = p[1], flag = p[2];
            if (flag == -1) {
                q.add(height);
            } else {
                map.put(height, map.getOrDefault(height, 0) + 1);
            }

            while (!q.isEmpty()) {
                int peek = q.peek();
                if (map.containsKey(peek)) {
                    if (map.get(peek) == 1) map.remove(peek);
                    else map.put(peek, map.get(peek) - 1);
                    q.poll();
                } else {
                    break;
                }
            }

            int cur = q.peek();
            if (cur != prev) {
                List<Integer> list = new ArrayList<>();
                list.add(point);
                list.add(cur);
                ans.add(list);
                prev = cur;
            }
        }
        return ans;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png) å’Œ åŠ å…¥æˆ‘ä»¬çš„[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~ 

## ç»Ÿè®¡ä¿¡æ¯
| é€šè¿‡æ¬¡æ•° | æäº¤æ¬¡æ•° | ACæ¯”ç‡ |
| :------: | :------: | :------: |
|    33076    |    60980    |   54.2%   |

## æäº¤å†å²
| æäº¤æ—¶é—´ | æäº¤ç»“æœ | æ‰§è¡Œæ—¶é—´ |  å†…å­˜æ¶ˆè€—  | è¯­è¨€ |
| :------: | :------: | :------: | :--------: | :--------: |


## ç›¸ä¼¼é¢˜ç›®
|                             é¢˜ç›®                             | éš¾åº¦ |
| :----------------------------------------------------------: | :---------: |
| [æ‰è½çš„æ–¹å—](https://leetcode-cn.com/problems/falling-squares/) | å›°éš¾|
