---
title: 1223-æ·éª°å­æ¨¡æ‹Ÿ(Dice Roll Simulation)
date: 2021-12-03 22:18:57
categories:
  - å›°éš¾
tags:
  - æ•°ç»„
  - åŠ¨æ€è§„åˆ’
---

> åŸæ–‡é“¾æ¥: https://leetcode-cn.com/problems/dice-roll-simulation


## è‹±æ–‡åŸæ–‡
<div><p>A die simulator generates a random number from <code>1</code> to <code>6</code> for each roll. You introduced a constraint to the generator such that it cannot roll the number <code>i</code> more than <code>rollMax[i]</code> (<strong>1-indexed</strong>) consecutive times.</p>

<p>Given an array of integers <code>rollMax</code> and an integer <code>n</code>, return <em>the number of distinct sequences that can be obtained with exact </em><code>n</code><em> rolls</em>. Since the answer may be too large, return it <strong>modulo</strong> <code>10<sup>9</sup> + 7</code>.</p>

<p>Two sequences are considered different if at least one element differs from each other.</p>

<p>&nbsp;</p>
<p><strong>Example 1:</strong></p>

<pre>
<strong>Input:</strong> n = 2, rollMax = [1,1,2,2,2,3]
<strong>Output:</strong> 34
<strong>Explanation:</strong> There will be 2 rolls of die, if there are no constraints on the die, there are 6 * 6 = 36 possible combinations. In this case, looking at rollMax array, the numbers 1 and 2 appear at most once consecutively, therefore sequences (1,1) and (2,2) cannot occur, so the final answer is 36-2 = 34.
</pre>

<p><strong>Example 2:</strong></p>

<pre>
<strong>Input:</strong> n = 2, rollMax = [1,1,1,1,1,1]
<strong>Output:</strong> 30
</pre>

<p><strong>Example 3:</strong></p>

<pre>
<strong>Input:</strong> n = 3, rollMax = [1,1,1,2,2,3]
<strong>Output:</strong> 181
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>1 &lt;= n &lt;= 5000</code></li>
	<li><code>rollMax.length == 6</code></li>
	<li><code>1 &lt;= rollMax[i] &lt;= 15</code></li>
</ul>
</div>

## ä¸­æ–‡é¢˜ç›®
<div><p>æœ‰ä¸€ä¸ªéª°å­æ¨¡æ‹Ÿå™¨ä¼šæ¯æ¬¡æŠ•æ·çš„æ—¶å€™ç”Ÿæˆä¸€ä¸ª 1 åˆ° 6 çš„éšæœºæ•°ã€‚</p>

<p>ä¸è¿‡æˆ‘ä»¬åœ¨ä½¿ç”¨å®ƒæ—¶æœ‰ä¸ªçº¦æŸï¼Œå°±æ˜¯ä½¿å¾—æŠ•æ·éª°å­æ—¶ï¼Œ<strong>è¿ç»­</strong> æ·å‡ºæ•°å­—&nbsp;<code>i</code>&nbsp;çš„æ¬¡æ•°ä¸èƒ½è¶…è¿‡&nbsp;<code>rollMax[i]</code>ï¼ˆ<code>i</code>&nbsp;ä» 1 å¼€å§‹ç¼–å·ï¼‰ã€‚</p>

<p>ç°åœ¨ï¼Œç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„&nbsp;<code>rollMax</code>&nbsp;å’Œä¸€ä¸ªæ•´æ•°&nbsp;<code>n</code>ï¼Œè¯·ä½ æ¥è®¡ç®—æ·&nbsp;<code>n</code>&nbsp;æ¬¡éª°å­å¯å¾—åˆ°çš„ä¸åŒç‚¹æ•°åºåˆ—çš„æ•°é‡ã€‚</p>

<p>å‡å¦‚ä¸¤ä¸ªåºåˆ—ä¸­è‡³å°‘å­˜åœ¨ä¸€ä¸ªå…ƒç´ ä¸åŒï¼Œå°±è®¤ä¸ºè¿™ä¸¤ä¸ªåºåˆ—æ˜¯ä¸åŒçš„ã€‚ç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œæ‰€ä»¥è¯·è¿”å› <strong>æ¨¡&nbsp;<code>10^9 + 7</code></strong>&nbsp;ä¹‹åçš„ç»“æœã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre><strong>è¾“å…¥ï¼š</strong>n = 2, rollMax = [1,1,2,2,2,3]
<strong>è¾“å‡ºï¼š</strong>34
<strong>è§£é‡Šï¼š</strong>æˆ‘ä»¬æ· 2 æ¬¡éª°å­ï¼Œå¦‚æœæ²¡æœ‰çº¦æŸçš„è¯ï¼Œå…±æœ‰ 6 * 6 = 36 ç§å¯èƒ½çš„ç»„åˆã€‚ä½†æ˜¯æ ¹æ® rollMax æ•°ç»„ï¼Œæ•°å­— 1 å’Œ 2 æœ€å¤šè¿ç»­å‡ºç°ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°åºåˆ— (1,1) å’Œ (2,2)ã€‚å› æ­¤ï¼Œæœ€ç»ˆç­”æ¡ˆæ˜¯ 36-2 = 34ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre><strong>è¾“å…¥ï¼š</strong>n = 2, rollMax = [1,1,1,1,1,1]
<strong>è¾“å‡ºï¼š</strong>30
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre><strong>è¾“å…¥ï¼š</strong>n = 3, rollMax = [1,1,1,2,2,3]
<strong>è¾“å‡ºï¼š</strong>181
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= n &lt;= 5000</code></li>
	<li><code>rollMax.length == 6</code></li>
	<li><code>1 &lt;= rollMax[i] &lt;= 15</code></li>
</ul>
</div>

## é€šè¿‡ä»£ç 
<RecoDemo>
</RecoDemo>


## é«˜èµé¢˜è§£
## æ€è·¯

ç”¨ `dp[i][j][k]` è¡¨ç¤ºç¬¬ `i` è½®æ·éª°å­æ·å‡ºæ•°å­— `j` æ—¶ `j` è¿ç»­å‡ºç° `k` æ¬¡çš„ç»„åˆæ•°é‡ã€‚

é‚£ä¹ˆæœ‰çŠ¶æ€è½¬ç§»å¦‚ä¸‹ï¼š

**å½“ `j` å¹¶éåœ¨è¿ç»­å‡ºç°æ—¶ï¼ˆå³ `k == 1` æ—¶ï¼‰ï¼š**

```
// j å‡ºç° 1 æ¬¡çš„ç»„åˆæ•°ç­‰äºä¸Šä¸€è½®æŠ•å‡ºéæ•°å­— j çš„æ‰€æœ‰æƒ…å†µå’Œ
dp[i][j][1] = sum(dp[i - 1][other != j][:])
```

**å½“ `j` è¿ç»­å‡ºç° `k(k > 1)` æ¬¡æ—¶ï¼š**

```
if k <= rollMax[j]:
    // æœ¬è½®æŠ•å‡ºè¿ç»­å‡ºç° k æ¬¡æ•°å­— j çš„æƒ…å†µæ•°é‡ç­‰äºï¼šä¸Šä¸€è½®è¿ç»­æŠ•æ·å‡º k - 1 æ¬¡ j çš„æƒ…å†µæ•°é‡
    dp[i][j][k] = dp[i - 1][j][k - 1]
```

psï¼šå¾ˆå¤šåŒå­¦è¯´æµ‹è¯•ç”¨ä¾‹æ˜¯é”™çš„ï¼Œå¯èƒ½æ˜¯å› ä¸ºç†è§£é”™é¢˜æ„äº†ï¼Œé¢˜ç›®è¯´çš„æ˜¯ **è¿ç»­** æ·å‡ºæ•°å­— `i` çš„æ¬¡æ•°ä¸èƒ½è¶…è¿‡ `rollMax[i]`ï¼Œè€Œä¸æ˜¯æ•°å­—çš„æŠ•æ·æ€»æ•°ã€‚

å…·ä½“å®ç°ï¼š

```python
class Solution:
    def dieSimulator(self, n: int, rollMax: List[int]) -> int:
        dp = [[[0 for _ in range(16)] for _ in range(7)] for _ in range(n + 1)]
        mod = 10**9 + 7
                
        for i in range(1, n + 1):
            # æŠ•æ·çš„æ•°
            for j in range(1, 7):
                # ç¬¬ä¸€æ¬¡æŠ•æ·
                if i == 1:
                    dp[i][j][1] = 1
                    continue
                
                # æ•°å­— j è¿ç»­å‡ºç° k æ¬¡
                for k in range(2, rollMax[j - 1] + 1):
                    dp[i][j][k] = dp[i - 1][j][k - 1]
                    
                # å‰ä¸€æ¬¡æŠ•å‡ºçš„æ•°ä¸æ˜¯ j
                s = 0
                for l in range(1, 7):
                    if l == j:
                        continue
                    for k in range(1, 16):
                        s += dp[i - 1][l][k]
                        s %= mod
                dp[i][j][1] = s
        
        res = 0
        for j in range(1, 7):
            for k in range(1, 16):
                # æ±‚æŠ•æ· n æ¬¡æ—¶æ‰€æœ‰ç»„åˆæ€»å’Œ
                res += dp[n][j][k]
                res %= mod
                
        return res
```

----

## ğŸ±


## ç»Ÿè®¡ä¿¡æ¯
| é€šè¿‡æ¬¡æ•° | æäº¤æ¬¡æ•° | ACæ¯”ç‡ |
| :------: | :------: | :------: |
|    3468    |    7274    |   47.7%   |

## æäº¤å†å²
| æäº¤æ—¶é—´ | æäº¤ç»“æœ | æ‰§è¡Œæ—¶é—´ |  å†…å­˜æ¶ˆè€—  | è¯­è¨€ |
| :------: | :------: | :------: | :--------: | :--------: |
