---
title: 1248-ç»Ÿè®¡ã€Œä¼˜ç¾å­æ•°ç»„ã€(Count Number of Nice Subarrays)
categories:
  - ä¸­ç­‰
tags:
  - æ•°ç»„
  - å“ˆå¸Œè¡¨
  - æ•°å­¦
  - æ»‘åŠ¨çª—å£
abbrlink: 580881590
date: 2021-12-03 22:18:35
---

> åŸæ–‡é“¾æ¥: https://leetcode-cn.com/problems/count-number-of-nice-subarrays


## è‹±æ–‡åŸæ–‡
<div><p>Given an array of integers <code>nums</code> and an integer <code>k</code>. A continuous subarray is called <strong>nice</strong> if there are <code>k</code> odd numbers on it.</p>

<p>Return <em>the number of <strong>nice</strong> sub-arrays</em>.</p>

<p>&nbsp;</p>
<p><strong>Example 1:</strong></p>

<pre>
<strong>Input:</strong> nums = [1,1,2,1,1], k = 3
<strong>Output:</strong> 2
<strong>Explanation:</strong> The only sub-arrays with 3 odd numbers are [1,1,2,1] and [1,2,1,1].
</pre>

<p><strong>Example 2:</strong></p>

<pre>
<strong>Input:</strong> nums = [2,4,6], k = 1
<strong>Output:</strong> 0
<strong>Explanation:</strong> There is no odd numbers in the array.
</pre>

<p><strong>Example 3:</strong></p>

<pre>
<strong>Input:</strong> nums = [2,2,2,1,2,2,1,2,2,2], k = 2
<strong>Output:</strong> 16
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>1 &lt;= nums.length &lt;= 50000</code></li>
	<li><code>1 &lt;= nums[i] &lt;= 10^5</code></li>
	<li><code>1 &lt;= k &lt;= nums.length</code></li>
</ul></div>

## ä¸­æ–‡é¢˜ç›®
<div><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„&nbsp;<code>nums</code> å’Œä¸€ä¸ªæ•´æ•° <code>k</code>ã€‚</p>

<p>å¦‚æœæŸä¸ª <strong>è¿ç»­</strong> å­æ•°ç»„ä¸­æ°å¥½æœ‰ <code>k</code> ä¸ªå¥‡æ•°æ•°å­—ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸ªå­æ•°ç»„æ˜¯ã€Œ<strong>ä¼˜ç¾å­æ•°ç»„</strong>ã€ã€‚</p>

<p>è¯·è¿”å›è¿™ä¸ªæ•°ç»„ä¸­ã€Œä¼˜ç¾å­æ•°ç»„ã€çš„æ•°ç›®ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre><strong>è¾“å…¥ï¼š</strong>nums = [1,1,2,1,1], k = 3
<strong>è¾“å‡ºï¼š</strong>2
<strong>è§£é‡Šï¼š</strong>åŒ…å« 3 ä¸ªå¥‡æ•°çš„å­æ•°ç»„æ˜¯ [1,1,2,1] å’Œ [1,2,1,1] ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre><strong>è¾“å…¥ï¼š</strong>nums = [2,4,6], k = 1
<strong>è¾“å‡ºï¼š</strong>0
<strong>è§£é‡Šï¼š</strong>æ•°åˆ—ä¸­ä¸åŒ…å«ä»»ä½•å¥‡æ•°ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä¼˜ç¾å­æ•°ç»„ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre><strong>è¾“å…¥ï¼š</strong>nums = [2,2,2,1,2,2,1,2,2,2], k = 2
<strong>è¾“å‡ºï¼š</strong>16
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= nums.length &lt;= 50000</code></li>
	<li><code>1 &lt;= nums[i] &lt;= 10^5</code></li>
	<li><code>1 &lt;= k &lt;= nums.length</code></li>
</ul>
</div>

## é€šè¿‡ä»£ç 
<RecoDemo>
</RecoDemo>


## é«˜èµé¢˜è§£
#### è§£é¢˜æ€è·¯

ä¸€ã€æ»‘åŠ¨çª—å£

1. ä¸æ–­å³ç§» `right` æŒ‡é’ˆæ¥æ‰©å¤§æ»‘åŠ¨çª—å£ï¼Œä½¿å…¶åŒ…å« `k` ä¸ªå¥‡æ•°ï¼›

2. è‹¥å½“å‰æ»‘åŠ¨çª—å£åŒ…å«äº† `k` ä¸ªå¥‡æ•°ï¼Œåˆ™å¦‚ä¸‹ã€Œè®¡ç®—å½“å‰çª—å£çš„ä¼˜ç¾å­æ•°ç»„ä¸ªæ•°ã€ï¼š

    * ç»Ÿè®¡ç¬¬ `1` ä¸ªå¥‡æ•°å·¦è¾¹çš„å¶æ•°ä¸ªæ•° `leftEvenCnt`ã€‚ è¿™ `leftEvenCnt` ä¸ªå¶æ•°éƒ½å¯ä»¥ä½œä¸ºã€Œä¼˜ç¾å­æ•°ç»„ã€çš„èµ·ç‚¹ï¼Œå› æ­¤èµ·ç‚¹çš„é€‰æ‹©æœ‰ `leftEvenCnt + 1` ç§ï¼ˆå› ä¸ºå¯ä»¥ä¸€ä¸ªå¶æ•°éƒ½ä¸å–ï¼Œå› æ­¤åˆ«å¿˜äº† +1 å–”ï¼‰ã€‚
    * ç»Ÿè®¡ç¬¬ `k` ä¸ªå¥‡æ•°å³è¾¹çš„å¶æ•°ä¸ªæ•° `rightEvenCnt`Â ã€‚ è¿™ `rightEvenCnt` ä¸ªå¶æ•°éƒ½å¯ä»¥ä½œä¸ºã€Œä¼˜ç¾å­æ•°ç»„ã€çš„ç»ˆç‚¹ï¼Œå› æ­¤ç»ˆç‚¹çš„é€‰æ‹©æœ‰ `rightEvenCnt + 1` ç§ï¼ˆå› ä¸ºå¯ä»¥ä¸€ä¸ªå¶æ•°éƒ½ä¸å–ï¼Œå› æ­¤åˆ«å¿˜äº† +1 å–”ï¼‰ã€‚
    * å› æ­¤ã€Œä¼˜ç¾å­æ•°ç»„ã€å·¦å³èµ·ç‚¹çš„é€‰æ‹©ç»„åˆæ•°ä¸º `(leftEvenCnt + 1) * (rightEvenCnt + 1)`ã€‚

ğŸ‘‡ä»£ç æ³¨é‡Šå¾ˆè¯¦ç»†ğŸ‘‡ï¼ˆæ—¶é—´å¤æ‚åº¦ $O(N)$ï¼Œç©ºé—´å¤æ‚åº¦ $O(1)$ï¼‰
```Java []
class Solution {
    public int numberOfSubarrays(int[] nums, int k) {
        int left = 0, right = 0, oddCnt = 0, res = 0;
        while (right < nums.length) {
            // å³æŒ‡é’ˆå…ˆèµ°ï¼Œæ¯é‡åˆ°ä¸€ä¸ªå¥‡æ•°åˆ™ oddCnt++ã€‚
            if ((nums[right++] & 1) == 1) {
                oddCnt++;
            }

            //  è‹¥å½“å‰æ»‘åŠ¨çª—å£ [left, right) ä¸­æœ‰ k ä¸ªå¥‡æ•°äº†ï¼Œè¿›å…¥æ­¤åˆ†æ”¯ç»Ÿè®¡å½“å‰æ»‘åŠ¨çª—å£ä¸­çš„ä¼˜ç¾å­æ•°ç»„ä¸ªæ•°ã€‚
            if (oddCnt == k) {
                // å…ˆå°†æ»‘åŠ¨çª—å£çš„å³è¾¹ç•Œå‘å³æ‹“å±•ï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªå¥‡æ•°ï¼ˆæˆ–å‡ºç•Œï¼‰
                // rightEvenCnt å³ä¸ºç¬¬ k ä¸ªå¥‡æ•°å³è¾¹çš„å¶æ•°çš„ä¸ªæ•°
                int tmp = right;
                while (right < nums.length && (nums[right] & 1) == 0) {
                    right++;
                }
                int rightEvenCnt = right - tmp;
                // leftEvenCnt å³ä¸ºç¬¬ 1 ä¸ªå¥‡æ•°å·¦è¾¹çš„å¶æ•°çš„ä¸ªæ•°
                int leftEvenCnt = 0;
                while ((nums[left] & 1) == 0) {
                    leftEvenCnt++;
                    left++;
                }
                // ç¬¬ 1 ä¸ªå¥‡æ•°å·¦è¾¹çš„ leftEvenCnt ä¸ªå¶æ•°éƒ½å¯ä»¥ä½œä¸ºä¼˜ç¾å­æ•°ç»„çš„èµ·ç‚¹
                // (å› ä¸ºç¬¬1ä¸ªå¥‡æ•°å·¦è¾¹å¯ä»¥1ä¸ªå¶æ•°éƒ½ä¸å–ï¼Œæ‰€ä»¥èµ·ç‚¹çš„é€‰æ‹©æœ‰ leftEvenCnt + 1 ç§ï¼‰
                // ç¬¬ k ä¸ªå¥‡æ•°å³è¾¹çš„ rightEvenCnt ä¸ªå¶æ•°éƒ½å¯ä»¥ä½œä¸ºä¼˜ç¾å­æ•°ç»„çš„ç»ˆç‚¹
                // (å› ä¸ºç¬¬kä¸ªå¥‡æ•°å³è¾¹å¯ä»¥1ä¸ªå¶æ•°éƒ½ä¸å–ï¼Œæ‰€ä»¥ç»ˆç‚¹çš„é€‰æ‹©æœ‰ rightEvenCnt + 1 ç§ï¼‰
                // æ‰€ä»¥è¯¥æ»‘åŠ¨çª—å£ä¸­ï¼Œä¼˜ç¾å­æ•°ç»„å·¦å³èµ·ç‚¹çš„é€‰æ‹©ç»„åˆæ•°ä¸º (leftEvenCnt + 1) * (rightEvenCnt + 1)
                res += (leftEvenCnt + 1) * (rightEvenCnt + 1);

                // æ­¤æ—¶ left æŒ‡å‘çš„æ˜¯ç¬¬ 1 ä¸ªå¥‡æ•°ï¼Œå› ä¸ºè¯¥åŒºé—´å·²ç»ç»Ÿè®¡å®Œäº†ï¼Œå› æ­¤ left å³ç§»ä¸€ä½ï¼ŒoddCnt--
                left++;
                oddCnt--;
            }

        }

        return res;
    }
}
```


äºŒã€å‰ç¼€å’Œ

1. è®¡ç®—å‰ç¼€å’Œæ•°ç»„ `arr`ï¼šéå†åŸæ•°ç»„ï¼Œæ¯éå†ä¸€ä¸ªå…ƒç´ ï¼Œè®¡ç®—å½“å‰çš„å‰ç¼€å’Œï¼ˆå³åˆ°å½“å‰å…ƒç´ ä¸ºæ­¢ï¼Œæ•°ç»„ä¸­æœ‰å¤šå°‘ä¸ªå¥‡æ•°ï¼‰ï¼›
2. å¯¹ä¸Šè¿°å‰ç¼€å’Œæ•°ç»„ï¼ŒåŒé‡å¾ªç¯ç»Ÿè®¡ `arr[j] - arr[i] == k` çš„ä¸ªæ•°ï¼Œè¿™æ ·åšæ˜¯ $O(N^2)$ çš„ï¼ˆè¿™é‡Œä¼šè¶…æ—¶å“¦ï¼‰ã€‚
3. **ä¼˜åŒ–**ï¼šå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åƒã€Œ[1. ä¸¤æ•°ä¹‹å’Œ](https://leetcode-cn.com/problems/two-sum/)ã€é‚£æ ·ä½¿ç”¨ `HashMap` ä¼˜åŒ–åˆ° $O(N)$ï¼Œé”®æ˜¯ã€Œå‰ç¼€å’Œã€ï¼Œå€¼æ˜¯ã€Œå‰ç¼€å’Œçš„ä¸ªæ•°ã€ï¼ˆä¸‹é¢ä»£ç ä¸­å…·ä½“ä½¿ç”¨çš„æ˜¯ `int[] prefixCnt` æ•°ç»„ï¼Œä¸‹æ ‡æ˜¯ã€Œå‰ç¼€å’Œã€ï¼Œå€¼æ˜¯ã€Œå‰ç¼€å’Œçš„ä¸ªæ•°ã€ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥éå†åŸæ•°ç»„ï¼Œæ¯éå†åˆ°ä¸€ä¸ªå…ƒç´ ï¼Œè®¡ç®—å½“å‰çš„å‰ç¼€å’Œ `sum`ï¼Œå°±åœ¨ `res` ä¸­ç´¯åŠ ä¸Šå‰ç¼€å’Œä¸º `sum - k` çš„ä¸ªæ•°ã€‚

ğŸ‘‡ä»£ç æ³¨é‡Šå¾ˆè¯¦ç»†ğŸ‘‡ï¼ˆæ—¶é—´å¤æ‚åº¦ $O(N)$ï¼Œç©ºé—´å¤æ‚åº¦ $O(N)$ï¼‰
```Java []
class Solution {
    public int numberOfSubarrays(int[] nums, int k) {
        // æ•°ç»„ prefixCnt çš„ä¸‹æ ‡æ˜¯å‰ç¼€å’Œï¼ˆå³å½“å‰å¥‡æ•°çš„ä¸ªæ•°ï¼‰ï¼Œå€¼æ˜¯å‰ç¼€å’Œçš„ä¸ªæ•°ã€‚
        int[] prefixCnt = new int[nums.length + 1];
        prefixCnt[0] = 1;
        // éå†åŸæ•°ç»„ï¼Œè®¡ç®—å½“å‰çš„å‰ç¼€å’Œï¼Œç»Ÿè®¡åˆ° prefixCnt æ•°ç»„ä¸­ï¼Œ
        // å¹¶ä¸”åœ¨ res ä¸­ç´¯åŠ ä¸Šä¸å½“å‰å‰ç¼€å’Œå·®å€¼ä¸º k çš„å‰ç¼€å’Œçš„ä¸ªæ•°ã€‚
        int res = 0, sum = 0;
        for (int num: nums) {
            sum += num & 1;
            prefixCnt[sum]++;
            if (sum >= k) {
                res += prefixCnt[sum - k];
            }       
        }
        return res;
    }
}
```

è°¢è°¢è§‚çœ‹ï½ï½ éšæ‰‹èµä¸ªã€Œçˆ±å¿ƒèµã€å†èµ°å§ï½ï½

## ç»Ÿè®¡ä¿¡æ¯
| é€šè¿‡æ¬¡æ•° | æäº¤æ¬¡æ•° | ACæ¯”ç‡ |
| :------: | :------: | :------: |
|    36225    |    64576    |   56.1%   |

## æäº¤å†å²
| æäº¤æ—¶é—´ | æäº¤ç»“æœ | æ‰§è¡Œæ—¶é—´ |  å†…å­˜æ¶ˆè€—  | è¯­è¨€ |
| :------: | :------: | :------: | :--------: | :--------: |
