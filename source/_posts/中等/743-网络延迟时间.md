---
title: 743-ç½‘ç»œå»¶è¿Ÿæ—¶é—´(Network Delay Time)
date: 2021-12-03 22:36:57
categories:
  - ä¸­ç­‰
tags:
  - æ·±åº¦ä¼˜å…ˆæœç´¢
  - å¹¿åº¦ä¼˜å…ˆæœç´¢
  - å›¾
  - æœ€çŸ­è·¯
  - å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰
---

> åŸæ–‡é“¾æ¥: https://leetcode-cn.com/problems/network-delay-time


## è‹±æ–‡åŸæ–‡
<div><p>You are given a network of <code>n</code> nodes, labeled from <code>1</code> to <code>n</code>. You are also given <code>times</code>, a list of travel times as directed edges <code>times[i] = (u<sub>i</sub>, v<sub>i</sub>, w<sub>i</sub>)</code>, where <code>u<sub>i</sub></code> is the source node, <code>v<sub>i</sub></code> is the target node, and <code>w<sub>i</sub></code> is the time it takes for a signal to travel from source to target.</p>

<p>We will send a signal from a given node <code>k</code>. Return the time it takes for all the <code>n</code> nodes to receive the signal. If it is impossible for all the <code>n</code> nodes to receive the signal, return <code>-1</code>.</p>

<p>&nbsp;</p>
<p><strong>Example 1:</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2019/05/23/931_example_1.png" style="width: 217px; height: 239px;" />
<pre>
<strong>Input:</strong> times = [[2,1,1],[2,3,1],[3,4,1]], n = 4, k = 2
<strong>Output:</strong> 2
</pre>

<p><strong>Example 2:</strong></p>

<pre>
<strong>Input:</strong> times = [[1,2,1]], n = 2, k = 1
<strong>Output:</strong> 1
</pre>

<p><strong>Example 3:</strong></p>

<pre>
<strong>Input:</strong> times = [[1,2,1]], n = 2, k = 2
<strong>Output:</strong> -1
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>1 &lt;= k &lt;= n &lt;= 100</code></li>
	<li><code>1 &lt;= times.length &lt;= 6000</code></li>
	<li><code>times[i].length == 3</code></li>
	<li><code>1 &lt;= u<sub>i</sub>, v<sub>i</sub> &lt;= n</code></li>
	<li><code>u<sub>i</sub> != v<sub>i</sub></code></li>
	<li><code>0 &lt;= w<sub>i</sub> &lt;= 100</code></li>
	<li>All the pairs <code>(u<sub>i</sub>, v<sub>i</sub>)</code> are <strong>unique</strong>. (i.e., no multiple edges.)</li>
</ul>
</div>

## ä¸­æ–‡é¢˜ç›®
<div><p>æœ‰ <code>n</code> ä¸ªç½‘ç»œèŠ‚ç‚¹ï¼Œæ ‡è®°ä¸º&nbsp;<code>1</code>&nbsp;åˆ° <code>n</code>ã€‚</p>

<p>ç»™ä½ ä¸€ä¸ªåˆ—è¡¨&nbsp;<code>times</code>ï¼Œè¡¨ç¤ºä¿¡å·ç»è¿‡ <strong>æœ‰å‘</strong> è¾¹çš„ä¼ é€’æ—¶é—´ã€‚&nbsp;<code>times[i] = (u<sub>i</sub>, v<sub>i</sub>, w<sub>i</sub>)</code>ï¼Œå…¶ä¸­&nbsp;<code>u<sub>i</sub></code>&nbsp;æ˜¯æºèŠ‚ç‚¹ï¼Œ<code>v<sub>i</sub></code>&nbsp;æ˜¯ç›®æ ‡èŠ‚ç‚¹ï¼Œ <code>w<sub>i</sub></code>&nbsp;æ˜¯ä¸€ä¸ªä¿¡å·ä»æºèŠ‚ç‚¹ä¼ é€’åˆ°ç›®æ ‡èŠ‚ç‚¹çš„æ—¶é—´ã€‚</p>

<p>ç°åœ¨ï¼Œä»æŸä¸ªèŠ‚ç‚¹&nbsp;<code>K</code>&nbsp;å‘å‡ºä¸€ä¸ªä¿¡å·ã€‚éœ€è¦å¤šä¹…æ‰èƒ½ä½¿æ‰€æœ‰èŠ‚ç‚¹éƒ½æ”¶åˆ°ä¿¡å·ï¼Ÿå¦‚æœä¸èƒ½ä½¿æ‰€æœ‰èŠ‚ç‚¹æ”¶åˆ°ä¿¡å·ï¼Œè¿”å›&nbsp;<code>-1</code> ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2019/05/23/931_example_1.png" style="height: 220px; width: 200px;" /></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>times = [[2,1,1],[2,3,1],[3,4,1]], n = 4, k = 2
<strong>è¾“å‡ºï¼š</strong>2
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>times = [[1,2,1]], n = 2, k = 1
<strong>è¾“å‡ºï¼š</strong>1
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>times = [[1,2,1]], n = 2, k = 2
<strong>è¾“å‡ºï¼š</strong>-1
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= k &lt;= n &lt;= 100</code></li>
	<li><code>1 &lt;= times.length &lt;= 6000</code></li>
	<li><code>times[i].length == 3</code></li>
	<li><code>1 &lt;= u<sub>i</sub>, v<sub>i</sub> &lt;= n</code></li>
	<li><code>u<sub>i</sub> != v<sub>i</sub></code></li>
	<li><code>0 &lt;= w<sub>i</sub> &lt;= 100</code></li>
	<li>æ‰€æœ‰ <code>(u<sub>i</sub>, v<sub>i</sub>)</code> å¯¹éƒ½ <strong>äº’ä¸ç›¸åŒ</strong>ï¼ˆå³ï¼Œä¸å«é‡å¤è¾¹ï¼‰</li>
</ul>
</div>

## é€šè¿‡ä»£ç 
<RecoDemo>
</RecoDemo>


## é«˜èµé¢˜è§£
> æ¬¢è¿[å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png) â¤ï¸ æä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡ä¸“é¡¹é¢˜è§£
åå°å›å¤ã€Œåˆ·é¢˜è·¯çº¿ã€æœ‰æƒŠå–œï¼Œæ›´æœ‰ã€Œé•¿æœŸé€å®ä½“ä¹¦ã€æ´»åŠ¨ç­‰ä½ æ¥ ğŸ‰ ğŸ‰ 

## åŸºæœ¬åˆ†æ

**ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬çº¦å®š $n$ ä¸ºç‚¹æ•°ï¼Œ$m$ ä¸ºè¾¹æ•°ã€‚**

æ ¹æ®é¢˜æ„ï¼Œé¦–å…ˆ $n$ çš„æ•°æ®èŒƒå›´åªæœ‰ $100$ï¼Œ$m$ çš„æ•°æ®èŒƒå›´ä¸º $6000$ï¼Œä½¿ç”¨ã€Œé‚»æ¥è¡¨ã€æˆ–ã€Œé‚»æ¥çŸ©é˜µã€æ¥å­˜å›¾éƒ½å¯ä»¥ã€‚

åŒæ—¶æ±‚çš„æ˜¯ã€Œ**ä» $k$ ç‚¹å‡ºå‘ï¼Œæ‰€æœ‰ç‚¹éƒ½è¢«è®¿é—®åˆ°çš„æœ€çŸ­æ—¶é—´**ã€ï¼Œå°†é—®é¢˜è½¬æ¢ä¸€ä¸‹å…¶å®å°±æ˜¯æ±‚ã€Œ**ä» $k$ ç‚¹å‡ºå‘ï¼Œåˆ°å…¶ä»–ç‚¹ $x$ çš„æœ€çŸ­è·ç¦»çš„æœ€å¤§å€¼**ã€ã€‚

---

## å­˜å›¾æ–¹å¼

åœ¨å¼€å§‹è®²è§£æœ€çŸ­è·¯ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹ ä¸‰ç§ã€Œå­˜å›¾ã€æ–¹å¼ã€‚

#### é‚»æ¥çŸ©é˜µ

è¿™æ˜¯ä¸€ç§ä½¿ç”¨äºŒç»´çŸ©é˜µæ¥è¿›è¡Œå­˜å›¾çš„æ–¹å¼ã€‚

é€‚ç”¨äºè¾¹æ•°è¾ƒå¤šçš„**ç¨ å¯†å›¾**ä½¿ç”¨ï¼Œå½“è¾¹æ•°é‡æ¥è¿‘ç‚¹çš„æ•°é‡çš„å¹³æ–¹ï¼Œå³ $m \approx n^2$ æ—¶ï¼Œå¯å®šä¹‰ä¸º**ç¨ å¯†å›¾**ã€‚

```Java []
// é‚»æ¥çŸ©é˜µæ•°ç»„ï¼šw[a][b] = c ä»£è¡¨ä» a åˆ° b æœ‰æƒé‡ä¸º c çš„è¾¹
int[][] w = new int[N][N];

// åŠ è¾¹æ“ä½œ
void add(int a, int b, int c) {
    w[a][b] = c;
}
```
#### é‚»æ¥è¡¨

è¿™ä¹Ÿæ˜¯ä¸€ç§åœ¨å›¾è®ºä¸­ååˆ†å¸¸è§çš„å­˜å›¾æ–¹å¼ï¼Œä¸æ•°ç»„å­˜å‚¨å•é“¾è¡¨çš„å®ç°ä¸€è‡´ï¼ˆå¤´æ’æ³•ï¼‰ã€‚

è¿™ç§å­˜å›¾æ–¹å¼åˆå«**é“¾å¼å‰å‘æ˜Ÿå­˜å›¾**ã€‚

é€‚ç”¨äºè¾¹æ•°è¾ƒå°‘çš„**ç¨€ç–å›¾**ä½¿ç”¨ï¼Œå½“è¾¹æ•°é‡æ¥è¿‘ç‚¹çš„æ•°é‡ï¼Œå³ $m \approx n$ æ—¶ï¼Œå¯å®šä¹‰ä¸º**ç¨€ç–å›¾**ã€‚

```Java []
int[] he = new int[N], e = new int[M], ne = new int[M], w = new int[M];
int idx;

void add(int a, int b, int c) {
    e[idx] = b;
    ne[idx] = he[a];
    he[a] = idx;
    w[idx] = c;
    idx++;
}
```

é¦–å…ˆ `idx` æ˜¯ç”¨æ¥å¯¹è¾¹è¿›è¡Œç¼–å·çš„ï¼Œç„¶åå¯¹å­˜å›¾ç”¨åˆ°çš„å‡ ä¸ªæ•°ç»„ä½œç®€å•è§£é‡Šï¼š
* `he` æ•°ç»„ï¼šå­˜å‚¨æ˜¯æŸä¸ªèŠ‚ç‚¹æ‰€å¯¹åº”çš„è¾¹çš„é›†åˆï¼ˆé“¾è¡¨ï¼‰çš„å¤´ç»“ç‚¹ï¼›
* `e`  æ•°ç»„ï¼šç”±äºè®¿é—®æŸä¸€æ¡è¾¹æŒ‡å‘çš„èŠ‚ç‚¹ï¼›
* `ne` æ•°ç»„ï¼šç”±äºæ˜¯ä»¥é“¾è¡¨çš„å½¢å¼è¿›è¡Œå­˜è¾¹ï¼Œè¯¥æ•°ç»„å°±æ˜¯ç”¨äºæ‰¾åˆ°ä¸‹ä¸€æ¡è¾¹ï¼›
* `w`  æ•°ç»„ï¼šç”¨äºè®°å½•æŸæ¡è¾¹çš„æƒé‡ä¸ºå¤šå°‘ã€‚

å› æ­¤å½“æˆ‘ä»¬æƒ³è¦éå†æ‰€æœ‰ç”± `a` ç‚¹å‘å‡ºçš„è¾¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š

```Java []
for (int i = he[a]; i != -1; i = ne[i]) {
    int b = e[i], c = w[i]; // å­˜åœ¨ç”± a æŒ‡å‘ b çš„è¾¹ï¼Œæƒé‡ä¸º c
}
```

#### ç±»

è¿™æ˜¯ä¸€ç§æœ€ç®€å•ï¼Œä½†æ˜¯ç›¸æ¯”ä¸Šè¿°ä¸¤ç§å­˜å›¾æ–¹å¼ï¼Œä½¿ç”¨å¾—è¾ƒå°‘çš„å­˜å›¾æ–¹å¼ã€‚

åªæœ‰å½“æˆ‘ä»¬éœ€è¦ç¡®ä¿æŸä¸ªæ“ä½œå¤æ‚åº¦ä¸¥æ ¼ä¸º $O(m)$ æ—¶ï¼Œæ‰ä¼šè€ƒè™‘ä½¿ç”¨ã€‚

å…·ä½“çš„ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªç±»æ¥è®°å½•æœ‰å‘è¾¹ä¿¡æ¯ï¼š

```Java []
class Edge {
    // ä»£è¡¨ä» a åˆ° b æœ‰ä¸€æ¡æƒé‡ä¸º c çš„è¾¹
    int a, b, c;
    Edge(int _a, int _b, int _c) {
        a = _a; b = _b; c = _c;
    }
}
```

é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ List å­˜èµ·æ‰€æœ‰çš„è¾¹å¯¹è±¡ï¼Œå¹¶åœ¨éœ€è¦éå†æ‰€æœ‰è¾¹çš„æ—¶å€™ï¼Œè¿›è¡Œéå†ï¼š

```Java []
List<Edge> es = new ArrayList<>();

...

for (Edge e : es) {
    ...
}
```

---

## Floydï¼ˆé‚»æ¥çŸ©é˜µï¼‰

æ ¹æ®ã€ŒåŸºæœ¬åˆ†æã€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤æ‚åº¦ä¸º $O(n^3)$ çš„ã€Œå¤šæºæ±‡æœ€çŸ­è·¯ã€ç®—æ³• Floyd ç®—æ³•è¿›è¡Œæ±‚è§£ï¼ŒåŒæ—¶ä½¿ç”¨ã€Œé‚»æ¥çŸ©é˜µã€æ¥è¿›è¡Œå­˜å›¾ã€‚

æ­¤æ—¶è®¡ç®—é‡çº¦ä¸º $10^6$ï¼Œå¯ä»¥è¿‡ã€‚

è·‘ä¸€é Floydï¼Œå¯ä»¥å¾—åˆ°ã€Œ**ä»ä»»æ„èµ·ç‚¹å‡ºå‘ï¼Œåˆ°è¾¾ä»»æ„èµ·ç‚¹çš„æœ€çŸ­è·ç¦»**ã€ã€‚ç„¶åä»æ‰€æœ‰ $w[k][x]$ ä¸­å– $max$ å³æ˜¯ã€Œ**ä» $k$ ç‚¹å‡ºå‘ï¼Œåˆ°å…¶ä»–ç‚¹ $x$ çš„æœ€çŸ­è·ç¦»çš„æœ€å¤§å€¼**ã€ã€‚

![image.png](../images/network-delay-time-0.png)

ä»£ç ï¼š
```Java []
class Solution {
    int N = 110, M = 6010;
    // é‚»æ¥çŸ©é˜µæ•°ç»„ï¼šw[a][b] = c ä»£è¡¨ä» a åˆ° b æœ‰æƒé‡ä¸º c çš„è¾¹
    int[][] w = new int[N][N];
    int INF = 0x3f3f3f3f;
    int n, k;
    public int networkDelayTime(int[][] ts, int _n, int _k) {
        n = _n; k = _k;
        // åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ
        for (int i = 1; i <= n; i++) {
            for (int j = 1; j <= n; j++) {
                w[i][j] = w[j][i] = i == j ? 0 : INF;
            }
        }
        // å­˜å›¾
        for (int[] t : ts) {
            int u = t[0], v = t[1], c = t[2];
            w[u][v] = c;
        }
        // æœ€çŸ­è·¯
        floyd();
        // éå†ç­”æ¡ˆ
        int ans = 0;
        for (int i = 1; i <= n; i++) {
            ans = Math.max(ans, w[k][i]);
        }
        return ans >= INF / 2 ? -1 : ans;
    }
    void floyd() {
        // floyd åŸºæœ¬æµç¨‹ä¸ºä¸‰å±‚å¾ªç¯ï¼š
        // æšä¸¾ä¸­è½¬ç‚¹ - æšä¸¾èµ·ç‚¹ - æšä¸¾ç»ˆç‚¹ - æ¾å¼›æ“ä½œ        
        for (int p = 1; p <= n; p++) {
            for (int i = 1; i <= n; i++) {
                for (int j = 1; j <= n; j++) {
                    w[i][j] = Math.min(w[i][j], w[i][p] + w[p][j]);
                }
            }
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n^2)$

---

## æœ´ç´  Dijkstraï¼ˆé‚»æ¥çŸ©é˜µï¼‰

åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤æ‚åº¦ä¸º $O(n^2)$ çš„ã€Œå•æºæœ€çŸ­è·¯ã€ç®—æ³•æœ´ç´  Dijkstra ç®—æ³•è¿›è¡Œæ±‚è§£ï¼ŒåŒæ—¶ä½¿ç”¨ã€Œé‚»æ¥çŸ©é˜µã€æ¥è¿›è¡Œå­˜å›¾ã€‚

æ ¹æ®é¢˜æ„ï¼Œ$k$ ç‚¹ä½œä¸ºæºç‚¹ï¼Œè·‘ä¸€é Dijkstra æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»æºç‚¹ $k$ åˆ°å…¶ä»–ç‚¹ $x$ çš„æœ€çŸ­è·ç¦»ï¼Œå†ä»æ‰€æœ‰æœ€çŸ­è·¯ä¸­å– $max$ å³æ˜¯ã€Œ**ä» $k$ ç‚¹å‡ºå‘ï¼Œåˆ°å…¶ä»–ç‚¹ $x$ çš„æœ€çŸ­è·ç¦»çš„æœ€å¤§å€¼**ã€ã€‚

æœ´ç´  Dijkstra å¤æ‚åº¦ä¸º $O(n^2)$ï¼Œå¯ä»¥è¿‡ã€‚

![image.png](../images/network-delay-time-1.png)

ä»£ç ï¼š
```Java []
class Solution {
    int N = 110, M = 6010;
    // é‚»æ¥çŸ©é˜µæ•°ç»„ï¼šw[a][b] = c ä»£è¡¨ä» a åˆ° b æœ‰æƒé‡ä¸º c çš„è¾¹
    int[][] w = new int[N][N];
    // dist[x] = y ä»£è¡¨ä»ã€Œæºç‚¹/èµ·ç‚¹ã€åˆ° x çš„æœ€çŸ­è·ç¦»ä¸º y
    int[] dist = new int[N];
    // è®°å½•å“ªäº›ç‚¹å·²ç»è¢«æ›´æ–°è¿‡
    boolean[] vis = new boolean[N];
    int INF = 0x3f3f3f3f;
    int n, k;
    public int networkDelayTime(int[][] ts, int _n, int _k) {
        n = _n; k = _k;
        // åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ
        for (int i = 1; i <= n; i++) {
            for (int j = 1; j <= n; j++) {
                w[i][j] = w[j][i] = i == j ? 0 : INF;
            }
        }
        // å­˜å›¾
        for (int[] t : ts) {
            int u = t[0], v = t[1], c = t[2];
            w[u][v] = c;
        }
        // æœ€çŸ­è·¯
        dijkstra();
        // éå†ç­”æ¡ˆ
        int ans = 0;
        for (int i = 1; i <= n; i++) {
            ans = Math.max(ans, dist[i]);
        }
        return ans > INF / 2 ? -1 : ans;
    }
    void dijkstra() {
        // èµ·å§‹å…ˆå°†æ‰€æœ‰çš„ç‚¹æ ‡è®°ä¸ºã€Œæœªæ›´æ–°ã€å’Œã€Œè·ç¦»ä¸ºæ­£æ— ç©·ã€
        Arrays.fill(vis, false);
        Arrays.fill(dist, INF);
        // åªæœ‰èµ·ç‚¹æœ€çŸ­è·ç¦»ä¸º 0
        dist[k] = 0;
        // è¿­ä»£ n æ¬¡
        for (int p = 1; p <= n; p++) {
            // æ¯æ¬¡æ‰¾åˆ°ã€Œæœ€çŸ­è·ç¦»æœ€å°ã€ä¸”ã€Œæœªè¢«æ›´æ–°ã€çš„ç‚¹ t
            int t = -1;
            for (int i = 1; i <= n; i++) {
                if (!vis[i] && (t == -1 || dist[i] < dist[t])) t = i;
            }
            // æ ‡è®°ç‚¹ t ä¸ºå·²æ›´æ–°
            vis[t] = true;
            // ç”¨ç‚¹ t çš„ã€Œæœ€å°è·ç¦»ã€æ›´æ–°å…¶ä»–ç‚¹
            for (int i = 1; i <= n; i++) {
                dist[i] = Math.min(dist[i], dist[t] + w[t][i]);
            }
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n^2)$

---

## å †ä¼˜åŒ– Dijkstraï¼ˆé‚»æ¥è¡¨ï¼‰

ç”±äºè¾¹æ•°æ®èŒƒå›´ä¸ç®—å¤§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¤æ‚åº¦ä¸º $O(m\log{n})$ çš„å †ä¼˜åŒ– Dijkstra ç®—æ³•è¿›è¡Œæ±‚è§£ã€‚

å †ä¼˜åŒ– Dijkstra ç®—æ³•ä¸æœ´ç´  Dijkstra éƒ½æ˜¯ã€Œå•æºæœ€çŸ­è·¯ã€ç®—æ³•ã€‚

è·‘ä¸€éå †ä¼˜åŒ– Dijkstra ç®—æ³•æ±‚æœ€çŸ­è·¯ï¼Œå†ä»æ‰€æœ‰æœ€çŸ­è·¯ä¸­å– $max$ å³æ˜¯ã€Œ**ä» $k$ ç‚¹å‡ºå‘ï¼Œåˆ°å…¶ä»–ç‚¹ $x$ çš„æœ€çŸ­è·ç¦»çš„æœ€å¤§å€¼**ã€ã€‚

æ­¤æ—¶ç®—æ³•å¤æ‚åº¦ä¸º $O(m\log{n})$ï¼Œå¯ä»¥è¿‡ã€‚

![image.png](../images/network-delay-time-2.png)

ä»£ç ï¼š
```Java []
class Solution {
    int N = 110, M = 6010;
    // é‚»æ¥è¡¨
    int[] he = new int[N], e = new int[M], ne = new int[M], w = new int[M];
    // dist[x] = y ä»£è¡¨ä»ã€Œæºç‚¹/èµ·ç‚¹ã€åˆ° x çš„æœ€çŸ­è·ç¦»ä¸º y
    int[] dist = new int[N];
    // è®°å½•å“ªäº›ç‚¹å·²ç»è¢«æ›´æ–°è¿‡
    boolean[] vis = new boolean[N];
    int n, k, idx;
    int INF = 0x3f3f3f3f;
    void add(int a, int b, int c) {
        e[idx] = b;
        ne[idx] = he[a];
        he[a] = idx;
        w[idx] = c;
        idx++;
    }
    public int networkDelayTime(int[][] ts, int _n, int _k) {
        n = _n; k = _k;
        // åˆå§‹åŒ–é“¾è¡¨å¤´
        Arrays.fill(he, -1);
        // å­˜å›¾
        for (int[] t : ts) {
            int u = t[0], v = t[1], c = t[2];
            add(u, v, c);
        }
        // æœ€çŸ­è·¯
        dijkstra();
        // éå†ç­”æ¡ˆ
        int ans = 0;
        for (int i = 1; i <= n; i++) {
            ans = Math.max(ans, dist[i]);
        }
        return ans > INF / 2 ? -1 : ans;
    }
    void dijkstra() {
        // èµ·å§‹å…ˆå°†æ‰€æœ‰çš„ç‚¹æ ‡è®°ä¸ºã€Œæœªæ›´æ–°ã€å’Œã€Œè·ç¦»ä¸ºæ­£æ— ç©·ã€
        Arrays.fill(vis, false);
        Arrays.fill(dist, INF);
        // åªæœ‰èµ·ç‚¹æœ€çŸ­è·ç¦»ä¸º 0
        dist[k] = 0;
        // ä½¿ç”¨ã€Œä¼˜å…ˆé˜Ÿåˆ—ã€å­˜å‚¨æ‰€æœ‰å¯ç”¨äºæ›´æ–°çš„ç‚¹
        // ä»¥ (ç‚¹ç¼–å·, åˆ°èµ·ç‚¹çš„è·ç¦») è¿›è¡Œå­˜å‚¨ï¼Œä¼˜å…ˆå¼¹å‡ºã€Œæœ€çŸ­è·ç¦»ã€è¾ƒå°çš„ç‚¹
        PriorityQueue<int[]> q = new PriorityQueue<>((a,b)->a[1]-b[1]);
        q.add(new int[]{k, 0});
        while (!q.isEmpty()) {
            // æ¯æ¬¡ä»ã€Œä¼˜å…ˆé˜Ÿåˆ—ã€ä¸­å¼¹å‡º
            int[] poll = q.poll();
            int id = poll[0], step = poll[1];
            // å¦‚æœå¼¹å‡ºçš„ç‚¹è¢«æ ‡è®°ã€Œå·²æ›´æ–°ã€ï¼Œåˆ™è·³è¿‡
            if (vis[id]) continue;
            // æ ‡è®°è¯¥ç‚¹ã€Œå·²æ›´æ–°ã€ï¼Œå¹¶ä½¿ç”¨è¯¥ç‚¹æ›´æ–°å…¶ä»–ç‚¹çš„ã€Œæœ€çŸ­è·ç¦»ã€
            vis[id] = true;
            for (int i = he[id]; i != -1; i = ne[i]) {
                int j = e[i];
                if (dist[j] > dist[id] + w[i]) {
                    dist[j] = dist[id] + w[i];
                    q.add(new int[]{j, dist[j]});
                }
            }
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(m\log{n} + n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m)$

---

## Bellman Fordï¼ˆç±» & é‚»æ¥è¡¨ï¼‰

è™½ç„¶é¢˜ç›®è§„å®šäº†ä¸å­˜åœ¨ã€Œè´Ÿæƒè¾¹ã€ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨å¯ä»¥åœ¨ã€Œè´Ÿæƒå›¾ä¸­æ±‚æœ€çŸ­è·¯ã€çš„ Bellman Ford è¿›è¡Œæ±‚è§£ï¼Œè¯¥ç®—æ³•ä¹Ÿæ˜¯ã€Œå•æºæœ€çŸ­è·¯ã€ç®—æ³•ï¼Œå¤æ‚åº¦ä¸º $O(n * m)$ã€‚

é€šå¸¸ä¸ºäº†ç¡®ä¿ $O(n * m)$ï¼Œå¯ä»¥å•ç‹¬å»ºä¸€ä¸ªç±»ä»£è¡¨è¾¹ï¼Œå°†æ‰€æœ‰è¾¹å­˜å…¥é›†åˆä¸­ï¼Œåœ¨ $n$ æ¬¡æ¾å¼›æ“ä½œä¸­ç›´æ¥å¯¹è¾¹é›†åˆè¿›è¡Œéå†ï¼ˆä»£ç è§ $P1$ï¼‰ã€‚

ç”±äºæœ¬é¢˜è¾¹çš„æ•°é‡çº§å¤§äºç‚¹çš„æ•°é‡çº§ï¼Œå› æ­¤ä¹Ÿèƒ½å¤Ÿç»§ç»­ä½¿ç”¨ã€Œé‚»æ¥è¡¨ã€çš„æ–¹å¼è¿›è¡Œè¾¹çš„éå†ï¼Œéå†æ‰€æœ‰è¾¹çš„å¤æ‚åº¦çš„ä¸‹ç•Œä¸º $O(n)$ï¼Œä¸Šç•Œå¯ä»¥ç¡®ä¿ä¸è¶…è¿‡ $O(m)$ï¼ˆä»£ç è§ $P2$ï¼‰ã€‚

![image.png](../images/network-delay-time-3.png)

ä»£ç ï¼š
```Java []
class Solution {
    class Edge {
        int a, b, c;
        Edge(int _a, int _b, int _c) {
            a = _a; b = _b; c = _c;
        }
    }
    int N = 110, M = 6010;
    // dist[x] = y ä»£è¡¨ä»ã€Œæºç‚¹/èµ·ç‚¹ã€åˆ° x çš„æœ€çŸ­è·ç¦»ä¸º y
    int[] dist = new int[N];
    int INF = 0x3f3f3f3f;
    int n, m, k;
    // ä½¿ç”¨ç±»è¿›è¡Œå­˜è¾¹
    List<Edge> es = new ArrayList<>();
    public int networkDelayTime(int[][] ts, int _n, int _k) {
        n = _n; k = _k;
        m = ts.length;
        // å­˜å›¾
        for (int[] t : ts) {
            int u = t[0], v = t[1], c = t[2];
            es.add(new Edge(u, v, c));
        }
        // æœ€çŸ­è·¯
        bf();
        // éå†ç­”æ¡ˆ
        int ans = 0;
        for (int i = 1; i <= n; i++) {
            ans = Math.max(ans, dist[i]);
        }
        return ans > INF / 2 ? -1 : ans;
    }
    void bf() {
        // èµ·å§‹å…ˆå°†æ‰€æœ‰çš„ç‚¹æ ‡è®°ä¸ºã€Œè·ç¦»ä¸ºæ­£æ— ç©·ã€
        Arrays.fill(dist, INF);
        // åªæœ‰èµ·ç‚¹æœ€çŸ­è·ç¦»ä¸º 0
        dist[k] = 0;
        // è¿­ä»£ n æ¬¡
        for (int p = 1; p <= n; p++) {
            int[] prev = dist.clone();
            // æ¯æ¬¡éƒ½ä½¿ç”¨ä¸Šä¸€æ¬¡è¿­ä»£çš„ç»“æœï¼Œæ‰§è¡Œæ¾å¼›æ“ä½œ
            for (Edge e : es) {
                int a = e.a, b = e.b, c = e.c;
                dist[b] = Math.min(dist[b], prev[a] + c);
            }
        }
    }
}
```
```Java []
class Solution {
    int N = 110, M = 6010;
    // é‚»æ¥è¡¨
    int[] he = new int[N], e = new int[M], ne = new int[M], w = new int[M];
    // dist[x] = y ä»£è¡¨ä»ã€Œæºç‚¹/èµ·ç‚¹ã€åˆ° x çš„æœ€çŸ­è·ç¦»ä¸º y
    int[] dist = new int[N];
    int INF = 0x3f3f3f3f;
    int n, m, k, idx;
    void add(int a, int b, int c) {
        e[idx] = b;
        ne[idx] = he[a];
        he[a] = idx;
        w[idx] = c;
        idx++;
    }
    public int networkDelayTime(int[][] ts, int _n, int _k) {
        n = _n; k = _k;
        m = ts.length;
        // åˆå§‹åŒ–é“¾è¡¨å¤´
        Arrays.fill(he, -1);
        // å­˜å›¾
        for (int[] t : ts) {
            int u = t[0], v = t[1], c = t[2];
            add(u, v, c);
        }
        // æœ€çŸ­è·¯
        bf();
        // éå†ç­”æ¡ˆ
        int ans = 0;
        for (int i = 1; i <= n; i++) {
            ans = Math.max(ans, dist[i]);
        }
        return ans > INF / 2 ? -1 : ans;
    }
    void bf() {
        // èµ·å§‹å…ˆå°†æ‰€æœ‰çš„ç‚¹æ ‡è®°ä¸ºã€Œè·ç¦»ä¸ºæ­£æ— ç©·ã€
        Arrays.fill(dist, INF);
        // åªæœ‰èµ·ç‚¹æœ€çŸ­è·ç¦»ä¸º 0
        dist[k] = 0;
        // è¿­ä»£ n æ¬¡
        for (int p = 1; p <= n; p++) {
            int[] prev = dist.clone();
            // æ¯æ¬¡éƒ½ä½¿ç”¨ä¸Šä¸€æ¬¡è¿­ä»£çš„ç»“æœï¼Œæ‰§è¡Œæ¾å¼›æ“ä½œ
            for (int a = 1; a <= n; a++) {
                for (int i = he[a]; i != -1; i = ne[i]) {
                    int b = e[i];
                    dist[b] = Math.min(dist[b], prev[a] + w[i]);
                }
            }
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n*m)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m)$

---

## SPFAï¼ˆé‚»æ¥è¡¨ï¼‰

SPFA æ˜¯å¯¹ Bellman Ford çš„ä¼˜åŒ–å®ç°ï¼Œå¯ä»¥ä½¿ç”¨é˜Ÿåˆ—è¿›è¡Œä¼˜åŒ–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ˆè¿›è¡Œä¼˜åŒ–ã€‚

é€šå¸¸æƒ…å†µä¸‹å¤æ‚åº¦ä¸º $O(k*m)$ï¼Œ$k$ ä¸€èˆ¬ä¸º $4$ åˆ° $5$ï¼Œæœ€åæƒ…å†µä¸‹ä»ä¸º $O(n * m)$ï¼Œå½“æ•°æ®ä¸ºç½‘æ ¼å›¾æ—¶ï¼Œå¤æ‚åº¦ä¼šä» $O(k*m)$ é€€åŒ–ä¸º $O(n*m)$ã€‚

![image.png](../images/network-delay-time-4.png)

ä»£ç ï¼š
```Java []
class Solution {
    int N = 110, M = 6010;
    // é‚»æ¥è¡¨
    int[] he = new int[N], e = new int[M], ne = new int[M], w = new int[M];
    // dist[x] = y ä»£è¡¨ä»ã€Œæºç‚¹/èµ·ç‚¹ã€åˆ° x çš„æœ€çŸ­è·ç¦»ä¸º y
    int[] dist = new int[N];
    // è®°å½•å“ªä¸€ä¸ªç‚¹ã€Œå·²åœ¨é˜Ÿåˆ—ã€ä¸­
    boolean[] vis = new boolean[N];
    int INF = 0x3f3f3f3f;
    int n, k, idx;
    void add(int a, int b, int c) {
        e[idx] = b;
        ne[idx] = he[a];
        he[a] = idx;
        w[idx] = c;
        idx++;
    }
    public int networkDelayTime(int[][] ts, int _n, int _k) {
        n = _n; k = _k;
        // åˆå§‹åŒ–é“¾è¡¨å¤´
        Arrays.fill(he, -1);
        // å­˜å›¾
        for (int[] t : ts) {
            int u = t[0], v = t[1], c = t[2];
            add(u, v, c);
        }
        // æœ€çŸ­è·¯
        spfa();
        // éå†ç­”æ¡ˆ
        int ans = 0;
        for (int i = 1; i <= n; i++) {
            ans = Math.max(ans, dist[i]);
        }
        return ans > INF / 2 ? -1 : ans;
    }
    void spfa() {
        // èµ·å§‹å…ˆå°†æ‰€æœ‰çš„ç‚¹æ ‡è®°ä¸ºã€Œæœªå…¥é˜Ÿã€å’Œã€Œè·ç¦»ä¸ºæ­£æ— ç©·ã€
        Arrays.fill(vis, false);
        Arrays.fill(dist, INF);
        // åªæœ‰èµ·ç‚¹æœ€çŸ­è·ç¦»ä¸º 0
        dist[k] = 0;
        // ä½¿ç”¨ã€ŒåŒç«¯é˜Ÿåˆ—ã€å­˜å‚¨ï¼Œå­˜å‚¨çš„æ˜¯ç‚¹ç¼–å·
        Deque<Integer> d = new ArrayDeque<>();
        // å°†ã€Œæºç‚¹/èµ·ç‚¹ã€è¿›è¡Œå…¥é˜Ÿï¼Œå¹¶æ ‡è®°ã€Œå·²å…¥é˜Ÿã€
        d.addLast(k);
        vis[k] = true;
        while (!d.isEmpty()) {
            // æ¯æ¬¡ä»ã€ŒåŒç«¯é˜Ÿåˆ—ã€ä¸­å–å‡ºï¼Œå¹¶æ ‡è®°ã€Œæœªå…¥é˜Ÿã€
            int poll = d.pollFirst();
            vis[poll] = false;
            // å°è¯•ä½¿ç”¨è¯¥ç‚¹ï¼Œæ›´æ–°å…¶ä»–ç‚¹çš„æœ€çŸ­è·ç¦»
            // å¦‚æœæ›´æ–°çš„ç‚¹ï¼Œæœ¬èº«ã€Œæœªå…¥é˜Ÿã€åˆ™åŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œå¹¶æ ‡è®°ã€Œå·²å…¥é˜Ÿã€
            for (int i = he[poll]; i != -1; i = ne[i]) {
                int j = e[i];
                if (dist[j] > dist[poll] + w[i]) {
                    dist[j] = dist[poll] + w[i];
                    if (vis[j]) continue;
                    d.addLast(j);
                    vis[j] = true;
                }
            }
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n*m)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m)$

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

ä¹Ÿæ¬¢è¿ä½  [å…³æ³¨æˆ‘](https://oscimg.oschina.net/oscnet/up-19688dc1af05cf8bdea43b2a863038ab9e5.png)ï¼ˆå…¬ä¸»å·åå°å›å¤ã€Œé€ä¹¦ã€å³å¯å‚ä¸çœ‹é¢˜è§£å­¦ç®—æ³•é€å®ä½“ä¹¦é•¿æœŸæ´»åŠ¨ï¼‰æˆ– åŠ å…¥[ã€Œç»„é˜Ÿæ‰“å¡ã€](https://leetcode-cn.com/u/ac_oier/)å°ç¾¤ ï¼Œæä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡é¢˜è§£ã€‚

æ‰€æœ‰é¢˜è§£å·²ç»åŠ å…¥ [åˆ·é¢˜æŒ‡å—](https://github.com/SharingSource/LogicStack-LeetCode/wiki)ï¼Œæ¬¢è¿ star å“¦ ~ 

## ç»Ÿè®¡ä¿¡æ¯
| é€šè¿‡æ¬¡æ•° | æäº¤æ¬¡æ•° | ACæ¯”ç‡ |
| :------: | :------: | :------: |
|    61410    |    117166    |   52.4%   |

## æäº¤å†å²
| æäº¤æ—¶é—´ | æäº¤ç»“æœ | æ‰§è¡Œæ—¶é—´ |  å†…å­˜æ¶ˆè€—  | è¯­è¨€ |
| :------: | :------: | :------: | :--------: | :--------: |
