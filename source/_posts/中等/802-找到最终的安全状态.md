---
title: 802-æ‰¾åˆ°æœ€ç»ˆçš„å®‰å…¨çŠ¶æ€(Find Eventual Safe States)
categories:
  - ä¸­ç­‰
tags:
  - æ·±åº¦ä¼˜å…ˆæœç´¢
  - å¹¿åº¦ä¼˜å…ˆæœç´¢
  - å›¾
  - æ‹“æ‰‘æ’åº
abbrlink: 2371400856
date: 2021-12-03 22:32:39
---

> åŸæ–‡é“¾æ¥: https://leetcode-cn.com/problems/find-eventual-safe-states


## è‹±æ–‡åŸæ–‡
<div><p>There is a directed graph of <code>n</code> nodes with each node labeled from <code>0</code> to <code>n - 1</code>. The graph is represented by a <strong>0-indexed</strong> 2D integer array <code>graph</code> where <code>graph[i]</code> is an integer array of nodes adjacent to node <code>i</code>, meaning there is an edge from node <code>i</code> to each node in <code>graph[i]</code>.</p>

<p>A node is a <strong>terminal node</strong> if there are no outgoing edges. A node is a <strong>safe node</strong> if every possible path starting from that node leads to a <strong>terminal node</strong>.</p>

<p>Return <em>an array containing all the <strong>safe nodes</strong> of the graph</em>. The answer should be sorted in <strong>ascending</strong> order.</p>

<p>&nbsp;</p>
<p><strong>Example 1:</strong></p>
<img alt="Illustration of graph" src="https://s3-lc-upload.s3.amazonaws.com/uploads/2018/03/17/picture1.png" style="height: 171px; width: 600px;" />
<pre>
<strong>Input:</strong> graph = [[1,2],[2,3],[5],[0],[5],[],[]]
<strong>Output:</strong> [2,4,5,6]
<strong>Explanation:</strong> The given graph is shown above.
Nodes 5 and 6 are terminal nodes as there are no outgoing edges from either of them.
Every path starting at nodes 2, 4, 5, and 6 all lead to either node 5 or 6.</pre>

<p><strong>Example 2:</strong></p>

<pre>
<strong>Input:</strong> graph = [[1,2,3,4],[1,2],[3,4],[0,4],[]]
<strong>Output:</strong> [4]
<strong>Explanation:</strong>
Only node 4 is a terminal node, and every path starting at node 4 leads to node 4.
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>n == graph.length</code></li>
	<li><code>1 &lt;= n &lt;= 10<sup>4</sup></code></li>
	<li><code>0 &lt;= graph[i].length &lt;= n</code></li>
	<li><code>0 &lt;= graph[i][j] &lt;= n - 1</code></li>
	<li><code>graph[i]</code> is sorted in a strictly increasing order.</li>
	<li>The graph may contain self-loops.</li>
	<li>The number of edges in the graph will be in the range <code>[1, 4 * 10<sup>4</sup>]</code>.</li>
</ul>
</div>

## ä¸­æ–‡é¢˜ç›®
<div><p>åœ¨æœ‰å‘å›¾ä¸­ï¼Œä»¥æŸä¸ªèŠ‚ç‚¹ä¸ºèµ·å§‹èŠ‚ç‚¹ï¼Œä»è¯¥ç‚¹å‡ºå‘ï¼Œæ¯ä¸€æ­¥æ²¿ç€å›¾ä¸­çš„ä¸€æ¡æœ‰å‘è¾¹è¡Œèµ°ã€‚å¦‚æœåˆ°è¾¾çš„èŠ‚ç‚¹æ˜¯ç»ˆç‚¹ï¼ˆå³å®ƒæ²¡æœ‰è¿å‡ºçš„æœ‰å‘è¾¹ï¼‰ï¼Œåˆ™åœæ­¢ã€‚</p>

<p>å¯¹äºä¸€ä¸ªèµ·å§‹èŠ‚ç‚¹ï¼Œå¦‚æœä»è¯¥èŠ‚ç‚¹å‡ºå‘ï¼Œ<strong>æ— è®ºæ¯ä¸€æ­¥é€‰æ‹©æ²¿å“ªæ¡æœ‰å‘è¾¹è¡Œèµ°</strong>ï¼Œæœ€åå¿…ç„¶åœ¨æœ‰é™æ­¥å†…åˆ°è¾¾ç»ˆç‚¹ï¼Œåˆ™å°†è¯¥èµ·å§‹èŠ‚ç‚¹ç§°ä½œæ˜¯ <strong>å®‰å…¨</strong> çš„ã€‚</p>

<p>è¿”å›ä¸€ä¸ªç”±å›¾ä¸­æ‰€æœ‰å®‰å…¨çš„èµ·å§‹èŠ‚ç‚¹ç»„æˆçš„æ•°ç»„ä½œä¸ºç­”æ¡ˆã€‚ç­”æ¡ˆæ•°ç»„ä¸­çš„å…ƒç´ åº”å½“æŒ‰ <strong>å‡åº</strong> æ’åˆ—ã€‚</p>

<p>è¯¥æœ‰å‘å›¾æœ‰ <code>n</code> ä¸ªèŠ‚ç‚¹ï¼ŒæŒ‰ <code>0</code> åˆ° <code>n - 1</code> ç¼–å·ï¼Œå…¶ä¸­ <code>n</code> æ˜¯&nbsp;<code>graph</code>&nbsp;çš„èŠ‚ç‚¹æ•°ã€‚å›¾ä»¥ä¸‹è¿°å½¢å¼ç»™å‡ºï¼š<code>graph[i]</code> æ˜¯ç¼–å· <code>j</code> èŠ‚ç‚¹çš„ä¸€ä¸ªåˆ—è¡¨ï¼Œæ»¡è¶³ <code>(i, j)</code> æ˜¯å›¾çš„ä¸€æ¡æœ‰å‘è¾¹ã€‚</p>

<p>&nbsp;</p>

<div class="original__bRMd">
<div>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<img alt="Illustration of graph" src="https://s3-lc-upload.s3.amazonaws.com/uploads/2018/03/17/picture1.png" style="height: 171px; width: 600px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>graph = [[1,2],[2,3],[5],[0],[5],[],[]]
<strong>è¾“å‡ºï¼š</strong>[2,4,5,6]
<strong>è§£é‡Šï¼š</strong>ç¤ºæ„å›¾å¦‚ä¸Šã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>graph = [[1,2,3,4],[1,2],[3,4],[0,4],[]]
<strong>è¾“å‡ºï¼š</strong>[4]
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>n == graph.length</code></li>
	<li><code>1 &lt;= n &lt;= 10<sup>4</sup></code></li>
	<li><code>0 &lt;= graph[i].length &lt;= n</code></li>
	<li><code>graph[i]</code> æŒ‰ä¸¥æ ¼é€’å¢é¡ºåºæ’åˆ—ã€‚</li>
	<li>å›¾ä¸­å¯èƒ½åŒ…å«è‡ªç¯ã€‚</li>
	<li>å›¾ä¸­è¾¹çš„æ•°ç›®åœ¨èŒƒå›´ <code>[1, 4 * 10<sup>4</sup>]</code> å†…ã€‚</li>
</ul>
</div>
</div>
</div>

## é€šè¿‡ä»£ç 
<RecoDemo>
</RecoDemo>


## é«˜èµé¢˜è§£
> æ¬¢è¿å…³æ³¨æˆ‘ â¤ï¸ æä¾›å†™ã€Œè¯æ˜ã€&ã€Œæ€è·¯ã€çš„é«˜è´¨é‡ä¸“é¡¹é¢˜è§£
åå°å›å¤ã€Œåˆ·é¢˜è·¯çº¿ã€æœ‰æƒŠå–œï¼Œæ›´æœ‰ã€Œé•¿æœŸé€å®ä½“ä¹¦ã€æ´»åŠ¨ç­‰ä½ æ¥ ğŸ‰ ğŸ‰ 

## åŸºæœ¬åˆ†æ & æ‹“æ‰‘æ’åº

ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä»¤ç‚¹æ•°ä¸º $n$ï¼Œè¾¹æ•°ä¸º $m$ã€‚

**åœ¨å›¾è®ºä¸­ï¼Œä¸€ä¸ªæœ‰å‘æ— ç¯å›¾å¿…ç„¶å­˜åœ¨è‡³å°‘ä¸€ä¸ªæ‹“æ‰‘åºä¸ä¹‹å¯¹åº”ï¼Œåä¹‹äº¦ç„¶ã€‚**

å¦‚æœå¯¹æ‹“æ‰‘æ’åºä¸ç†Ÿæ‚‰çš„å°ä¼™ä¼´ï¼Œå¯ä»¥çœ‹çœ‹ [æ‹“æ‰‘æ’åº](https://baike.baidu.com/item/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F)ã€‚

**ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å±•å¼€æˆä¸€ç»´åºåˆ—ï¼Œå¯¹äºåºåˆ—ä¸­ä»»æ„çš„èŠ‚ç‚¹ $(u, v)$ï¼Œå¦‚æœåœ¨åºåˆ—ä¸­ $u$ åœ¨ $v$ çš„å‰é¢ï¼Œåˆ™è¯´æ˜åœ¨å›¾ä¸­å­˜åœ¨ä» $u$ å‡ºå‘è¾¾åˆ° $v$ çš„é€šè·¯ï¼Œå³ $u$ æ’åœ¨ $v$ çš„å‰é¢ã€‚åä¹‹äº¦ç„¶ã€‚**

åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥æ™“ã€Œå…¥åº¦ã€å’Œã€Œå‡ºåº¦ã€çš„æ¦‚å¿µï¼š

* å…¥åº¦ï¼šæœ‰å¤šå°‘æ¡è¾¹ç›´æ¥æŒ‡å‘è¯¥èŠ‚ç‚¹ï¼›
* å‡ºåº¦ï¼šç”±è¯¥èŠ‚ç‚¹æŒ‡å‡ºè¾¹çš„æœ‰å¤šå°‘æ¡ã€‚

å› æ­¤ï¼Œå¯¹äºæœ‰å‘å›¾çš„æ‹“æ‰‘æ’åºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ€è·¯è¾“å‡ºæ‹“æ‰‘åºï¼ˆ`BFS` æ–¹å¼ï¼‰ï¼š

1. èµ·å§‹æ—¶ï¼Œå°†æ‰€æœ‰å…¥åº¦ä¸º $0$ çš„èŠ‚ç‚¹è¿›è¡Œå…¥é˜Ÿï¼ˆå…¥åº¦ä¸º $0$ï¼Œè¯´æ˜æ²¡æœ‰è¾¹æŒ‡å‘è¿™äº›èŠ‚ç‚¹ï¼Œå°†å®ƒä»¬æ”¾åˆ°æ‹“æ‰‘æ’åºçš„é¦–éƒ¨ï¼Œä¸ä¼šè¿åæ‹“æ‰‘åºå®šä¹‰ï¼‰ï¼›
2. **ä»é˜Ÿåˆ—ä¸­è¿›è¡ŒèŠ‚ç‚¹å‡ºé˜Ÿæ“ä½œï¼Œå‡ºé˜Ÿåºåˆ—å°±æ˜¯å¯¹åº”æˆ‘ä»¬è¾“å‡ºçš„æ‹“æ‰‘åº**ã€‚
    å¯¹äºå½“å‰å¼¹å‡ºçš„èŠ‚ç‚¹ $x$ï¼Œéå† $x$ çš„æ‰€æœ‰å‡ºåº¦ï¼Œå³éå†æ‰€æœ‰ç”± $x$ ç›´æ¥æŒ‡å‘çš„èŠ‚ç‚¹ $y$ï¼Œå¯¹ $y$ åšå…¥åº¦å‡ä¸€æ“ä½œï¼ˆå› ä¸º $x$ èŠ‚ç‚¹å·²ç»ä»é˜Ÿåˆ—ä¸­å¼¹å‡ºï¼Œè¢«æ·»åŠ åˆ°æ‹“æ‰‘åºä¸­ï¼Œç­‰ä»·äºä» $x$ èŠ‚ç‚¹ä»æœ‰å‘å›¾ä¸­è¢«ç§»é™¤ï¼Œç›¸åº”çš„ç”± $x$ å‘å‡ºçš„è¾¹ä¹Ÿåº”å½“è¢«åˆ é™¤ï¼Œå¸¦æ¥çš„å½±å“æ˜¯ä¸ $x$ ç›¸è¿çš„èŠ‚ç‚¹ $y$ çš„å…¥åº¦å‡ä¸€ï¼‰ï¼›
3. å¯¹ $y$ è¿›è¡Œå…¥åº¦å‡ä¸€ä¹‹åï¼Œæ£€æŸ¥ $y$ çš„å…¥åº¦æ˜¯å¦ä¸º $0$ï¼Œå¦‚æœä¸º $0$ åˆ™å°† $y$ å…¥é˜Ÿï¼ˆå½“ $y$ çš„å…¥åº¦ä¸º $0$ï¼Œè¯´æ˜æœ‰å‘å›¾ä¸­åœ¨ $y$ å‰é¢çš„æ‰€æœ‰çš„èŠ‚ç‚¹å‡è¢«æ·»åŠ åˆ°æ‹“æ‰‘åºä¸­ï¼Œæ­¤æ—¶ $y$ å¯ä»¥ä½œä¸ºæ‹“æ‰‘åºçš„æŸä¸ªç‰‡æ®µçš„é¦–éƒ¨è¢«æ·»åŠ ï¼Œè€Œä¸æ˜¯è¿åæ‹“æ‰‘åºçš„å®šä¹‰ï¼‰ï¼›
3. å¾ªç¯æµç¨‹ $2$ã€$3$ ç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºã€‚

![image.png](../images/find-eventual-safe-states-0.png)

---

## è¯æ˜

ä¸Šè¿° `BFS` æ–¹æ³•èƒ½å¤Ÿæ±‚å¾—ã€ŒæŸä¸ªæœ‰å‘æ— ç¯å›¾çš„æ‹“æ‰‘åºã€çš„å‰ææ˜¯ï¼š**æˆ‘ä»¬å¿…ç„¶èƒ½å¤Ÿæ‰¾åˆ°ï¼ˆè‡³å°‘ï¼‰ä¸€ä¸ªã€Œå…¥åº¦ä¸º $0$ çš„ç‚¹ã€ï¼Œåœ¨èµ·å§‹æ—¶å°†å…¶å…¥é˜Ÿã€‚**

è¿™å¯ä»¥ä½¿ç”¨åè¯æ³•è¿›è¡Œè¯æ˜ï¼šå‡è®¾æœ‰å‘æ— ç¯å›¾çš„æ‹“æ‰‘åºä¸å­˜åœ¨å…¥åº¦ä¸º $0$ çš„ç‚¹ã€‚

**é‚£ä¹ˆä»å›¾ä¸­çš„ä»»æ„èŠ‚ç‚¹ $x$ è¿›è¡Œå‡ºå‘ï¼Œæ²¿ç€è¾¹è¿›è¡Œåå‘æ£€ç´¢ï¼Œç”±äºä¸å­˜åœ¨å…¥åº¦ä¸º $0$ çš„èŠ‚ç‚¹ï¼Œå› æ­¤æ¯ä¸ªç‚¹éƒ½èƒ½å¤Ÿæ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚**

**å½“æˆ‘ä»¬æ‰¾åˆ°ä¸€æ¡é•¿åº¦ä¸º $n + 1$ çš„åå‘è·¯å¾„æ—¶ï¼Œç”±äºæˆ‘ä»¬å›¾ä¸­åªæœ‰ $n$ ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤å¿…ç„¶æœ‰è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹åœ¨è¯¥è·¯å¾„ä¸­é‡å¤å‡ºç°ï¼Œå³è¯¥åå‘è·¯å¾„ä¸­å­˜åœ¨ç¯ï¼Œä¸æˆ‘ä»¬ã€Œæœ‰å‘æ— ç¯å›¾ã€çš„èµ·å§‹æ¡ä»¶å†²çªã€‚**

å¾—è¯ã€Œæœ‰å‘æ— ç¯å›¾çš„æ‹“æ‰‘åºã€å¿…ç„¶å­˜åœ¨ï¼ˆè‡³å°‘ï¼‰ä¸€ä¸ªã€Œå…¥åº¦ä¸º $0$ çš„ç‚¹ã€ã€‚

å³æŒ‰ç…§ä¸Šè¿°çš„ `BFS` æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤ŸæŒ‰ç…§æµç¨‹è¿­ä»£ä¸‹å»ï¼Œç›´åˆ°å°†æœ‰å‘æ— ç¯å›¾çš„æ‰€æœ‰èŠ‚ç‚¹ä»é˜Ÿåˆ—ä¸­å¼¹å‡ºã€‚

åä¹‹ï¼Œå¦‚æœä¸€ä¸ªå›¾ä¸æ˜¯ã€Œæœ‰å‘æ— ç¯å›¾ã€çš„è¯ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•å°†æ‰€æœ‰èŠ‚ç‚¹å…¥é˜Ÿçš„ï¼Œå› æ­¤èƒ½å¤Ÿé€šè¿‡å…¥é˜ŸèŠ‚ç‚¹æ•°é‡æ˜¯å¦ä¸º $n$ æ¥åˆ¤æ–­æ˜¯å¦ä¸ºæœ‰å‘æ— ç¯å›¾ã€‚

---

## åå‘å›¾ + æ‹“æ‰‘æ’åº

å›åˆ°æœ¬é¢˜ï¼Œæ ¹æ®é¢˜ç›®å¯¹ã€Œå®‰å…¨èŠ‚ç‚¹ã€çš„å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ— æ³•è¿›å…¥ã€Œç¯ã€çš„è¯åˆ™æ˜¯å®‰å…¨çš„ï¼Œå¦åˆ™æ˜¯ä¸å®‰å…¨çš„ã€‚

å¦å¤–æˆ‘ä»¬å‘ç°ï¼Œ**å¦‚æœæƒ³è¦åˆ¤æ–­æŸä¸ªèŠ‚ç‚¹æ•° $x$ æ˜¯å¦å®‰å…¨ï¼Œèµ·å§‹æ—¶å°† $x$ è¿›è¡Œå…¥é˜Ÿï¼Œå¹¶è·‘ä¸€éæ‹“æ‰‘æ’åºæ˜¯ä¸è¶³å¤Ÿçš„ã€‚**

å› ä¸ºæˆ‘ä»¬æ— æ³•äº‹å…ˆç¡®ä¿ $x$ æ»¡è¶³å…¥åº¦ä¸º $0$ çš„è¦æ±‚ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å¤„ç†åˆ°ä¸ $x$ ç›¸è¿çš„èŠ‚ç‚¹ $y$ æ—¶ï¼Œå¯èƒ½ä¼šå­˜åœ¨ $y$ èŠ‚ç‚¹å…¥åº¦æ— æ³•å‡åˆ° $0$ çš„æƒ…å†µï¼Œå³æˆ‘ä»¬æ— æ³•è¾“å‡ºçœŸå®æ‹“æ‰‘åºä¸­ï¼Œä» $x$ èŠ‚ç‚¹å¼€å§‹åˆ°ç»“å°¾çš„å®Œæ•´éƒ¨åˆ†ã€‚

ä½†æ˜¯æ ¹æ®æˆ‘ä»¬ã€Œè¯æ˜ã€éƒ¨åˆ†çš„å¯å‘ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰è¾¹è¿›è¡Œåå‘ï¼Œè¿™æ—¶å€™ã€Œå…¥åº¦ã€å’Œã€Œå‡ºåº¦ã€ç¿»è½¬äº†ã€‚

å¯¹äºé‚£äº›åå‘å›¾ä¸­ã€Œå…¥åº¦ã€ä¸º $0$ çš„ç‚¹é›† $x$ï¼Œå…¶å®å°±æ˜¯åŸå›¾ä¸­ã€Œå‡ºåº¦ã€ä¸º $0$ çš„èŠ‚ç‚¹ï¼Œå®ƒä»¬ã€Œå‡ºåº¦ã€ä¸º $0$ï¼Œæ ¹æœ¬æ²¡æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œå¿…ç„¶æ— æ³•è¿›å…¥ç¯ï¼Œæ˜¯å®‰å…¨çš„ï¼›åŒæ—¶ç”±å®ƒä»¬åœ¨åå‘å›¾ä¸­æŒ‡å‘çš„èŠ‚ç‚¹ï¼ˆåœ¨åŸå›¾ä¸­**åªæŒ‡å‘**å®ƒä»¬çš„èŠ‚ç‚¹ï¼‰ï¼Œå¿…ç„¶ä¹Ÿæ˜¯æ— æ³•è¿›å…¥ç¯çš„ï¼Œå¯¹åº”åˆ°åå‘å›¾ä¸­ï¼Œå°±æ˜¯é‚£äº›å‡å» $x$ å¯¹åº”çš„å…¥åº¦ä¹‹åï¼Œå…¥åº¦ä¸º $0$ çš„èŠ‚ç‚¹ã€‚

å› æ­¤æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯å°†å›¾è¿›è¡Œåå‘ï¼Œå†è·‘ä¸€éæ‹“æ‰‘æ’åºï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹å‡ºç°åœ¨æ‹“æ‰‘åºåˆ—ï¼Œè¯´æ˜å…¶è¿›å…¥è¿‡é˜Ÿåˆ—ï¼Œè¯´æ˜å…¶å…¥åº¦ä¸º $0$ï¼Œå…¶æ˜¯å®‰å…¨çš„ï¼Œå…¶ä½™èŠ‚ç‚¹åˆ™æ˜¯åœ¨ç¯å†…éå®‰å…¨èŠ‚ç‚¹ã€‚

> å¦å¤–ï¼Œè¿™é‡Œçš„å­˜å›¾æ–¹å¼è¿˜æ˜¯ä½¿ç”¨å‰å‡ å¤©ä¸€ç›´ä½¿ç”¨çš„ã€Œé“¾å¼å‰å‘æ˜Ÿã€ï¼Œå…³äºå‡ ä¸ªæ•°ç»„çš„å®šä¹‰ä»¥åŠå…¶ä»–çš„å­˜å›¾æ–¹å¼ï¼Œå¦‚æœè¿˜æ˜¯æœ‰ä¸ç†Ÿæ‚‰çš„å°ä¼™ä¼´å¯ä»¥åœ¨ [è¿™é‡Œ](https://zhuanlan.zhihu.com/p/396576813) æŸ¥é˜…ï¼Œæœ¬æ¬¡ä¸å†èµ˜è¿°ã€‚

ä»£ç ï¼š
```Java []
class Solution {
    int N = (int)1e4+10, M = 4 * N;
    int idx;
    int[] he = new int[N], e = new int[M], ne = new int[M];
    int[] cnts = new int[N];
    void add(int a, int b) {
        e[idx] = b;
        ne[idx] = he[a];
        he[a] = idx++;
    }
    public List<Integer> eventualSafeNodes(int[][] g) {
        int n = g.length;
        // å­˜åå‘å›¾ï¼Œå¹¶ç»Ÿè®¡å…¥åº¦
        Arrays.fill(he, -1);
        for (int i = 0; i < n; i++) {
            for (int j : g[i]) {
                add(j, i);
                cnts[i]++;
            }
        }
        // BFS æ±‚åå‘å›¾æ‹“æ‰‘æ’åº
        Deque<Integer> d = new ArrayDeque<>();
        for (int i = 0; i < n; i++) {
            if (cnts[i] == 0) d.addLast(i);
        }
        while (!d.isEmpty()) {
            int poll = d.pollFirst();
            for (int i = he[poll]; i != -1; i = ne[i]) {
                int j = e[i];
                if (--cnts[j] == 0) d.addLast(j);
            }
        }
        // éå†ç­”æ¡ˆï¼šå¦‚æœæŸä¸ªèŠ‚ç‚¹å‡ºç°åœ¨æ‹“æ‰‘åºåˆ—ï¼Œè¯´æ˜å…¶è¿›å…¥è¿‡é˜Ÿåˆ—ï¼Œè¯´æ˜å…¶å…¥åº¦ä¸º 0
        List<Integer> ans = new ArrayList<>();
        for (int i = 0; i < n; i++) {
            if (cnts[i] == 0) ans.add(i);
        }
        return ans;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(n + m)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n + m)$

---

## æœ€å

**å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ ï¼Œè¯·ç»™é¢˜è§£ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ° ~ ("â–”â–¡â–”)/**

## ç»Ÿè®¡ä¿¡æ¯
| é€šè¿‡æ¬¡æ•° | æäº¤æ¬¡æ•° | ACæ¯”ç‡ |
| :------: | :------: | :------: |
|    32062    |    55558    |   57.7%   |

## æäº¤å†å²
| æäº¤æ—¶é—´ | æäº¤ç»“æœ | æ‰§è¡Œæ—¶é—´ |  å†…å­˜æ¶ˆè€—  | è¯­è¨€ |
| :------: | :------: | :------: | :--------: | :--------: |
